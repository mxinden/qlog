<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Main logging schema for qlog</title>
<meta content="Robin Marx" name="author">
<meta content="Luca Niccolini" name="author">
<meta content="Marten Seemann" name="author">
<meta content="Lucas Pardue" name="author">
<meta content="
       This document describes a high-level schema for a standardized logging format
called qlog.  This format allows easy sharing of data and the creation of reusable
visualization and debugging tools. The high-level schema in this document is
intended to be protocol-agnostic. Separate documents specify how the format should
be used for specific protocol data. The schema is also format-agnostic, and can be
represented in for example JSON, csv or protobuf. 
    " name="description">
<meta content="xml2rfc 3.15.3" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-quic-qlog-main-schema-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.15.3
    Python 3.10.9
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.1
    setuptools 65.6.0
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-ietf-quic-qlog-main-schema.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl > dt {
  float: left;
  margin-right: 1em;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: 14.5px;
}
.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Main logging schema for qlog</td>
<td class="right">January 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Marx, et al.</td>
<td class="center">Expires 28 July 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">QUIC</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-quic-qlog-main-schema-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-01-24" class="published">24 January 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-07-28">28 July 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Marx, <span class="editor">Ed.</span>
</div>
<div class="org">Akamai</div>
</div>
<div class="author">
      <div class="author-name">L. Niccolini, <span class="editor">Ed.</span>
</div>
<div class="org">Meta</div>
</div>
<div class="author">
      <div class="author-name">M. Seemann, <span class="editor">Ed.</span>
</div>
<div class="org">Protocol Labs</div>
</div>
<div class="author">
      <div class="author-name">L. Pardue, <span class="editor">Ed.</span>
</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Main logging schema for qlog</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a high-level schema for a standardized logging format
called qlog.  This format allows easy sharing of data and the creation of reusable
visualization and debugging tools. The high-level schema in this document is
intended to be protocol-agnostic. Separate documents specify how the format should
be used for specific protocol data. The schema is also format-agnostic, and can be
represented in for example JSON, csv or protobuf.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 July 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-notational-conventions" class="internal xref">Notational Conventions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1" class="keepWithNext"><a href="#section-1.1.1" class="auto internal xref">1.1.1</a>.  <a href="#name-schema-definition" class="internal xref">Schema definition</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.2">
                    <p id="section-toc.1-1.1.2.1.2.2.1" class="keepWithNext"><a href="#section-1.1.2" class="auto internal xref">1.1.2</a>.  <a href="#name-serialization-examples" class="internal xref">Serialization examples</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-design-goals" class="internal xref">Design goals</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-the-high-level-qlog-schema" class="internal xref">The high level qlog schema</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-summary" class="internal xref">Summary</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-traces" class="internal xref">traces</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-individual-trace-containers" class="internal xref">Individual Trace containers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-configuration" class="internal xref">Configuration</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-vantage_point" class="internal xref">vantage_point</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-field-name-semantics" class="internal xref">Field name semantics</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-timestamps" class="internal xref">Timestamps</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-category-and-event-type" class="internal xref">Category and Event Type</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="auto internal xref">3.4.3</a>.  <a href="#name-data" class="internal xref">Data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="auto internal xref">3.4.4</a>.  <a href="#name-protocol_type" class="internal xref">protocol_type</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.5">
                    <p id="section-toc.1-1.3.2.4.2.5.1"><a href="#section-3.4.5" class="auto internal xref">3.4.5</a>.  <a href="#name-triggers" class="internal xref">Triggers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.6">
                    <p id="section-toc.1-1.3.2.4.2.6.1"><a href="#section-3.4.6" class="auto internal xref">3.4.6</a>.  <a href="#name-group_id" class="internal xref">group_id</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.7">
                    <p id="section-toc.1-1.3.2.4.2.7.1"><a href="#section-3.4.7" class="auto internal xref">3.4.7</a>.  <a href="#name-common_fields" class="internal xref">common_fields</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-guidelines-for-event-defini" class="internal xref">Guidelines for event definition documents</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-event-design-guidelines" class="internal xref">Event design guidelines</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-event-importance-indicators" class="internal xref">Event importance indicators</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-custom-fields-2" class="internal xref">Custom fields</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-generic-events-and-data-cla" class="internal xref">Generic events and data classes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-raw-packet-and-frame-inform" class="internal xref">Raw packet and frame information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-generic-events" class="internal xref">Generic events</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-error" class="internal xref">error</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-warning" class="internal xref">warning</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-info" class="internal xref">info</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="auto internal xref">5.2.4</a>.  <a href="#name-debug" class="internal xref">debug</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a href="#section-5.2.5" class="auto internal xref">5.2.5</a>.  <a href="#name-verbose" class="internal xref">verbose</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-simulation-events" class="internal xref">Simulation events</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-scenario" class="internal xref">scenario</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-marker" class="internal xref">marker</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-serializing-qlog" class="internal xref">Serializing qlog</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-qlog-to-json-mapping" class="internal xref">qlog to JSON mapping</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-i-json" class="internal xref">I-JSON</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-truncated-values" class="internal xref">Truncated values</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-qlog-to-json-text-sequences" class="internal xref">qlog to JSON Text Sequences mapping</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-supporting-json-text-sequen" class="internal xref">Supporting JSON Text Sequences in tooling</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-other-optimized-formatting-" class="internal xref">Other optimized formatting options</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="auto internal xref">6.3.1</a>.  <a href="#name-data-structure-optimization" class="internal xref">Data structure optimizations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="auto internal xref">6.3.2</a>.  <a href="#name-compression" class="internal xref">Compression</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.3">
                    <p id="section-toc.1-1.6.2.3.2.3.1"><a href="#section-6.3.3" class="auto internal xref">6.3.3</a>.  <a href="#name-binary-formats" class="internal xref">Binary formats</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.4">
                    <p id="section-toc.1-1.6.2.3.2.4.1"><a href="#section-6.3.4" class="auto internal xref">6.3.4</a>.  <a href="#name-overview-and-summary" class="internal xref">Overview and summary</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-conversion-between-formats" class="internal xref">Conversion between formats</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-methods-of-access-and-gener" class="internal xref">Methods of access and generation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-set-file-output-destination" class="internal xref">Set file output destination via an environment variable</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-access-logs-via-a-well-know" class="internal xref">Access logs via a well-known endpoint</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-tooling-requirements" class="internal xref">Tooling requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-and-privacy-consid" class="internal xref">Security and privacy considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-change-log" class="internal xref">Change Log</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-since-draft-ietf-quic-qlog-" class="internal xref">Since draft-ietf-quic-qlog-main-schema-03:</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-since-draft-ietf-quic-qlog-m" class="internal xref">Since draft-ietf-quic-qlog-main-schema-02:</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-since-draft-ietf-quic-qlog-ma" class="internal xref">Since draft-ietf-quic-qlog-main-schema-01:</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-since-draft-ietf-quic-qlog-mai" class="internal xref">Since draft-ietf-quic-qlog-main-schema-00:</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#appendix-A.5" class="auto internal xref">A.5</a>.  <a href="#name-since-draft-marx-qlog-main-" class="internal xref">Since draft-marx-qlog-main-schema-draft-02:</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#appendix-A.6" class="auto internal xref">A.6</a>.  <a href="#name-since-draft-marx-qlog-main-s" class="internal xref">Since draft-marx-qlog-main-schema-01:</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7">
                <p id="section-toc.1-1.12.2.7.1"><a href="#appendix-A.7" class="auto internal xref">A.7</a>.  <a href="#name-since-draft-marx-qlog-main-sc" class="internal xref">Since draft-marx-qlog-main-schema-00:</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">There is currently a lack of an easily usable, standardized endpoint logging
format. Especially for the use case of debugging and evaluating modern Web
protocols and their performance, it is often difficult to obtain structured logs
that provide adequate information for tasks like problem root cause analysis.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document aims to provide a high-level schema and harness that describes the
general layout of an easily usable, shareable, aggregatable and structured logging
format. This high-level schema is protocol agnostic, with logging entries for
specific protocols and use cases being defined in other documents (see for example
<span>[<a href="#QLOG-QUIC" class="cite xref">QLOG-QUIC</a>]</span> for QUIC and <span>[<a href="#QLOG-H3" class="cite xref">QLOG-H3</a>]</span> for HTTP/3 and QPACK-related event
definitions).<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The goal of this high-level schema is to provide amenities and default
characteristics that each logging file should contain (or should be able to
contain), such that generic and reusable toolsets can be created that can deal
with logs from a variety of different protocols and use cases.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">As such, this document contains concepts such as versioning, metadata inclusion,
log aggregation, event grouping and log file size reduction techniques.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The qlog schema can be serialized in many ways (e.g., JSON, CBOR, protobuf,
etc). This document describes only how to employ <span>[<a href="#JSON" class="cite xref">JSON</a>]</span>, its subset
<span>[<a href="#I-JSON" class="cite xref">I-JSON</a>]</span>, and its streamable derivative
<span>[<a href="#JSON-Text-Sequences" class="cite xref">JSON-Text-Sequences</a>]</span>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1-6.1">
          <p id="section-1-6.1.1">Note to RFC editor: Please remove the follow paragraphs in this section before
publication.<a href="#section-1-6.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-7">Feedback and discussion are welcome at
<a href="https://github.com/quicwg/qlog">https://github.com/quicwg/qlog</a>. Readers are
advised to refer to the "editor's draft" at that URL for an up-to-date version
of this document.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Concrete examples of integrations of this schema in
various programming languages can be found at
<a href="https://github.com/quiclog/qlog/">https://github.com/quiclog/qlog/</a>.<a href="#section-1-8" class="pilcrow">¶</a></p>
<div id="data_types">
<section id="section-1.1">
        <h3 id="name-notational-conventions">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<div id="schema-definition">
<section id="section-1.1.1">
          <h4 id="name-schema-definition">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-schema-definition" class="section-name selfRef">Schema definition</a>
          </h4>
<p id="section-1.1.1-1">To define events and data structures, all qlog documents use the Concise
Data Definition Language <span>[<a href="#CDDL" class="cite xref">CDDL</a>]</span>. This document uses the basic
syntax, the specific <code>text</code>, <code>uint</code>, <code>float32</code>, <code>float64</code>, <code>bool</code>, and
<code>any</code> types, as well as the <code>.default</code>, <code>.size</code>, and <code>.regexp</code> control
operators, the <code>~</code> unwrapping operator, and the <code>$</code> extension point
syntax from <span>[<a href="#CDDL" class="cite xref">CDDL</a>]</span>.<a href="#section-1.1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1.1-2">Additionally, this document defines the following custom types for
clarity:<a href="#section-1.1.1-2" class="pilcrow">¶</a></p>
<span id="name-additional-cddl-type-defini"></span><div id="cddl-custom-types-def">
<figure id="figure-1">
            <div class="lang-cddl sourcecode" id="section-1.1.1-3.1">
<pre>
; CDDL's uint is defined as being 64-bit in size
; but for many protocol fields we want to be more restrictive
; and explicit
uint8 = uint .size 1
uint16 = uint .size 2
uint32 = uint .size 4
uint64 = uint .size 8

; an even-length lowercase string of hexadecimally encoded bytes
; examples: 82dc, 027339, 4cdbfd9bf0
; this is needed because the default CDDL binary string (bytes/bstr)
; is only CBOR and not JSON compatible
hexstring = text .regexp "([0-9a-f]{2})*"
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-additional-cddl-type-defini" class="selfRef">Additional CDDL type definitions</a>
            </figcaption></figure>
</div>
<p id="section-1.1.1-4">All timestamps and time-related values (e.g., offsets) in qlog are
logged as <code>float64</code> in the millisecond resolution.<a href="#section-1.1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1.1-5">Other qlog documents can define their own CDDL-compatible (struct) types
(e.g., separately for each Packet type that a protocol supports).<a href="#section-1.1.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.1.1-6.1">
              <p id="section-1.1.1-6.1.1">Note to RFC editor: Please remove the following text in this section before
publication.<a href="#section-1.1.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.1.1-7">The main general CDDL syntax conventions in this document a reader
should be aware of for easy reading comprehension are:<a href="#section-1.1.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.1-8.1">
              <code>? obj</code> : this object is optional<a href="#section-1.1.1-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.2">
              <code>TypeName1 / TypeName2</code> : a union of these two types (object can be either type 1 OR
type 2)<a href="#section-1.1.1-8.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.3">
              <code>obj: TypeName</code> : this object has this concrete type<a href="#section-1.1.1-8.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.4">
              <code>obj: [* TypeName]</code> : this object is an array of this type with
minimum size of 0 elements<a href="#section-1.1.1-8.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.5">
              <code>obj: [+ TypeName]</code> : this object is an array of this type with
minimum size of 1 element<a href="#section-1.1.1-8.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.6">
              <code>TypeName = ...</code> : defines a new type<a href="#section-1.1.1-8.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.7">
              <code>EnumName = "entry1" / "entry2" / entry3 / ...</code>: defines an enum<a href="#section-1.1.1-8.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.8">
              <code>StructName = { ... }</code> : defines a new struct type<a href="#section-1.1.1-8.8" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.9">
              <code>;</code> : single-line comment<a href="#section-1.1.1-8.9" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.10">
              <code>* text =&gt; any</code> : special syntax to indicate 0 or more fields that
have a string key that maps to any value. Used to indicate a generic
JSON object.<a href="#section-1.1.1-8.10" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-1.1.1-9">All timestamps and time-related values (e.g., offsets) in qlog are
logged as <code>float64</code> in the millisecond resolution.<a href="#section-1.1.1-9" class="pilcrow">¶</a></p>
<p id="section-1.1.1-10">Other qlog documents can define their own CDDL-compatible (struct) types
(e.g., separately for each Packet type that a protocol supports).<a href="#section-1.1.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="serialization-examples">
<section id="section-1.1.2">
          <h4 id="name-serialization-examples">
<a href="#section-1.1.2" class="section-number selfRef">1.1.2. </a><a href="#name-serialization-examples" class="section-name selfRef">Serialization examples</a>
          </h4>
<p id="section-1.1.2-1">Serialization examples in this document use JSON (<span>[<a href="#JSON" class="cite xref">JSON</a>]</span>) unless
otherwise indicated.<a href="#section-1.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="design-goals">
<section id="section-2">
      <h2 id="name-design-goals">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-design-goals" class="section-name selfRef">Design goals</a>
      </h2>
<p id="section-2-1">The main tenets for the qlog schema design are:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">Streamable, event-based logging<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.2">A flexible format that can reduce log producer overhead, at the cost of
increased complexity for consumers (e.g. tools)<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.3">Extensible and pragmatic<a href="#section-2-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.4">Aggregation and transformation friendly (e.g., the top-level element
for the non-streaming format is a container for individual traces,
group_ids can be used to tag events to a particular context)<a href="#section-2-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.5">Metadata is stored together with event data<a href="#section-2-2.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="top-level">
<section id="section-3">
      <h2 id="name-the-high-level-qlog-schema">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-the-high-level-qlog-schema" class="section-name selfRef">The high level qlog schema</a>
      </h2>
<p id="section-3-1">A qlog file should be able to contain several individual traces and logs from
multiple vantage points that are in some way related. To that end, the top-level
element in the qlog schema defines only a small set of "header" fields and an
array of component traces. For this document, the required "qlog_version" field
<span class="bcp14">MUST</span> have a value of "0.3".<a href="#section-3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-2">
        <dt id="section-3-2.1">Note:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.2">
          <p id="section-3-2.2.1">there have been several previously broadly deployed qlog versions based on older
drafts of this document (see draft-marx-qlog-main-schema). The old values for the
"qlog_version" field were "draft-00", "draft-01" and "draft-02". When qlog was
moved to the QUIC working group, we decided to switch to a new versioning scheme
which is independent of individual draft document numbers. However, we did start
from 0.3, as conceptually 0.0, 0.1 and 0.2 can map to draft-00, draft-01 and
draft-02.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-3">As qlog can be serialized in a variety of ways, the "qlog_format" field is used to
indicate which serialization option was chosen. Its value <span class="bcp14">MUST</span> either be one of
the options defined in this document (e.g., <a href="#concrete-formats" class="auto internal xref">Section 6</a>) or the field
must be omitted entirely, in which case it assumes the default value of "JSON".<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">In order to make it easier to parse and identify qlog files and their
serialization format, the "qlog_version" and "qlog_format" fields and their values
<span class="bcp14">SHOULD</span> be in the first 256 characters/bytes of the resulting log file.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">An example of the qlog file's top-level structure is shown in <a href="#qlog-file-def" class="auto internal xref">Figure 2</a>.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">Definition:<a href="#section-3-6" class="pilcrow">¶</a></p>
<span id="name-qlogfile-definition"></span><div id="qlog-file-def">
<figure id="figure-2">
        <div class="lang-cddl sourcecode" id="section-3-7.1">
<pre>
QlogFile = {
    qlog_version: text
    ? qlog_format: text .default "JSON"
    ? title: text
    ? description: text
    ? summary: Summary
    ? traces: [+ Trace / TraceError]
}
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-qlogfile-definition" class="selfRef">QlogFile definition</a>
        </figcaption></figure>
</div>
<p id="section-3-8">JSON serialization example:<a href="#section-3-8" class="pilcrow">¶</a></p>
<span id="name-qlogfile-example"></span><div id="qlog-file-ex">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-3-9.1">
<pre>
{
    "qlog_version": "0.3",
    "qlog_format": "JSON",
    "title": "Name of this particular qlog file (short)",
    "description": "Description for this group of traces (long)",
    "summary": {
        ...
    },
    "traces": [...]
}
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-qlogfile-example" class="selfRef">QlogFile example</a>
        </figcaption></figure>
</div>
<div id="summary">
<section id="section-3.1">
        <h3 id="name-summary">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-summary" class="section-name selfRef">Summary</a>
        </h3>
<p id="section-3.1-1">In a real-life deployment with a large amount of generated logs, it can be useful
to sort and filter logs based on some basic summarized or aggregated data (e.g.,
log length, packet loss rate, log location, presence of error events, ...). The
summary field (if present) <span class="bcp14">SHOULD</span> be on top of the qlog file, as this allows for
the file to be processed in a streaming fashion (i.e., the implementation could
just read up to and including the summary field and then only load the full logs
that are deemed interesting by the user).<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">As the summary field is highly deployment-specific, this document does not specify
any default fields or their semantics. Some examples of potential entries are
shown in <a href="#summary" class="auto internal xref">Section 3.1</a>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Definition:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<span id="name-summary-definition"></span><div id="summary-def">
<figure id="figure-4">
          <div class="lang-cddl sourcecode" id="section-3.1-4.1">
<pre>
Summary = {
    ; summary can contain any type of custom information
    ; text here doesn't mean the type text,
    ; but the fact that keys/names in the objects are strings
    * text =&gt; any
}
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-summary-definition" class="selfRef">Summary definition</a>
          </figcaption></figure>
</div>
<p id="section-3.1-5">JSON serialization example:<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<span id="name-summary-example"></span><div id="summary-ex">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-3.1-6.1">
<pre>
{
    "trace_count": 1,
    "max_duration": 5006,
    "max_outgoing_loss_rate": 0.013,
    "total_event_count": 568,
    "error_count": 2
}
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-summary-example" class="selfRef">Summary example</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="traces">
<section id="section-3.2">
        <h3 id="name-traces">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-traces" class="section-name selfRef">traces</a>
        </h3>
<p id="section-3.2-1">It is often advantageous to group several related qlog traces together in a single
file. For example, we can simultaneously perform logging on the client, on the
server and on a single point on their common network path. For analysis, it is
useful to aggregate these three individual traces together into a single file, so
it can be uniquely stored, transferred and annotated.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">As such, the "traces" array contains a list of individual qlog traces. Typical
qlogs will only contain a single trace in this array. These can later be combined
into a single qlog file by taking the "traces" entry/entries for each qlog file
individually and copying them to the "traces" array of a new, aggregated qlog
file. This is typically done in a post-processing step.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">The "traces" array can thus contain both normal traces (for the definition of the
Trace type, see <a href="#trace" class="auto internal xref">Section 3.3</a>), but also "error" entries. These indicate that we tried
to find/convert a file for inclusion in the aggregated qlog, but there was an
error during the process. Rather than silently dropping the erroneous file, we can
opt to explicitly include it in the qlog file as an entry in the "traces" array,
as shown in <a href="#trace-error-def" class="auto internal xref">Figure 6</a>.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Definition:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<span id="name-traceerror-definition"></span><div id="trace-error-def">
<figure id="figure-6">
          <div class="lang-cddl sourcecode" id="section-3.2-5.1">
<pre>
TraceError = {
    error_description: text
    ; the original URI at which we attempted to find the file
    ? uri: text
    ? vantage_point: VantagePoint
}
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-traceerror-definition" class="selfRef">TraceError definition</a>
          </figcaption></figure>
</div>
<p id="section-3.2-6">JSON serialization example:<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<span id="name-traceerror-example"></span><div id="trace-error-ex">
<figure id="figure-7">
          <div class="alignLeft art-text artwork" id="section-3.2-7.1">
<pre>
{
    "error_description": "File could not be found",
    "uri": "/srv/traces/today/latest.qlog",
    "vantage_point": { type: "server" }
}
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-traceerror-example" class="selfRef">TraceError example</a>
          </figcaption></figure>
</div>
<p id="section-3.2-8">Note that another way to combine events of different traces in a single qlog file
is through the use of the "group_id" field, discussed in <a href="#group-ids" class="auto internal xref">Section 3.4.6</a>.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trace">
<section id="section-3.3">
        <h3 id="name-individual-trace-containers">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-individual-trace-containers" class="section-name selfRef">Individual Trace containers</a>
        </h3>
<p id="section-3.3-1">The exact conceptual definition of a Trace can be fluid. For example, a trace
could contain all events for a single connection, for a single endpoint, for a
single measurement interval, for a single protocol, etc. As such, a Trace
container contains some metadata in addition to the logged events, see
<a href="#trace-def" class="auto internal xref">Figure 8</a>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">In the normal use case however, a trace is a log of a single data flow collected
at a single location or vantage point. For example, for QUIC, a single trace only
contains events for a single logical QUIC connection for either the client or the
server.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">The semantics and context of the trace can mainly be deduced from the entries in
the "common_fields" list and "vantage_point" field.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">Definition:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<span id="name-trace-definition"></span><div id="trace-def">
<figure id="figure-8">
          <div class="lang-cddl sourcecode" id="section-3.3-5.1">
<pre>
Trace = {
    ? title: text
    ? description: text
    ? configuration: Configuration
    ? common_fields: CommonFields
    ? vantage_point: VantagePoint
    events: [* Event]
}
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-trace-definition" class="selfRef">Trace definition</a>
          </figcaption></figure>
</div>
<p id="section-3.3-6">JSON serialization example:<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<span id="name-trace-example"></span><div id="trace-ex">
<figure id="figure-9">
          <div class="alignLeft art-text artwork" id="section-3.3-7.1">
<pre>
{
    "title": "Name of this particular trace (short)",
    "description": "Description for this trace (long)",
    "configuration": {
        "time_offset": 150
    },
    "common_fields": {
        "ODCID": "abcde1234",
        "time_format": "absolute"
    },
    "vantage_point": {
        "name": "backend-67",
        "type": "server"
    },
    "events": [...]
}
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-trace-example" class="selfRef">Trace example</a>
          </figcaption></figure>
</div>
<div id="configuration">
<section id="section-3.3.1">
          <h4 id="name-configuration">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-configuration" class="section-name selfRef">Configuration</a>
          </h4>
<p id="section-3.3.1-1">We take into account that a qlog file is usually not used in isolation, but by
means of various tools. Especially when aggregating various traces together or
preparing traces for a demonstration, one might wish to persist certain tool-based
settings inside the qlog file itself. For this, the configuration field is used.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">The configuration field can be viewed as a generic metadata field that tools can
fill with their own fields, based on per-tool logic. It is best practice for tools
to prefix each added field with their tool name to prevent collisions across
tools. This document only defines two optional, standard, tool-independent
configuration settings: "time_offset" and "original_uris".<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3">Definition:<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<span id="name-configuration-definition"></span><div id="configuration-def">
<figure id="figure-10">
            <div class="lang-cddl sourcecode" id="section-3.3.1-4.1">
<pre>
Configuration = {
    ; time_offset is in milliseconds
    time_offset: float64
    original_uris:[* text]
    * text =&gt; any
}
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-configuration-definition" class="selfRef">Configuration definition</a>
            </figcaption></figure>
</div>
<p id="section-3.3.1-5">JSON serialization example:<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
<span id="name-configuration-example"></span><div id="configuration-ex">
<figure id="figure-11">
            <div class="alignLeft art-text artwork" id="section-3.3.1-6.1">
<pre>
{
    "time_offset": 150,
    "original_uris": [
        "https://example.org/trace1.qlog",
        "https://example.org/trace2.qlog"
    ]
}
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-configuration-example" class="selfRef">Configuration example</a>
            </figcaption></figure>
</div>
<div id="timeoffset">
<section id="section-3.3.1.1">
            <h5 id="name-time_offset">
<a href="#section-3.3.1.1" class="section-number selfRef">3.3.1.1. </a><a href="#name-time_offset" class="section-name selfRef">time_offset</a>
            </h5>
<p id="section-3.3.1.1-1">The time_offset field indicates by how many milliseconds the starting time of the current
trace should be offset. This is useful when comparing logs taken from various
systems, where clocks might not be perfectly synchronous. Users could use manual
tools or automated logic to align traces in time and the found optimal offsets can
be stored in this field for future usage. The default value is 0.<a href="#section-3.3.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="originaluris">
<section id="section-3.3.1.2">
            <h5 id="name-original_uris">
<a href="#section-3.3.1.2" class="section-number selfRef">3.3.1.2. </a><a href="#name-original_uris" class="section-name selfRef">original_uris</a>
            </h5>
<p id="section-3.3.1.2-1">The original_uris field is used when merging multiple individual qlog files or
other source files (e.g., when converting .pcaps to qlog). It allows to keep
better track where certain data came from. It is a simple array of strings. It is
an array instead of a single string, since a single qlog trace can be made up out
of an aggregation of multiple component qlog traces as well. The default value is
an empty array.<a href="#section-3.3.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="custom-fields">
<section id="section-3.3.1.3">
            <h5 id="name-custom-fields">
<a href="#section-3.3.1.3" class="section-number selfRef">3.3.1.3. </a><a href="#name-custom-fields" class="section-name selfRef">custom fields</a>
            </h5>
<p id="section-3.3.1.3-1">Tools can add optional custom metadata to the "configuration" field to store state
and make it easier to share specific data viewpoints and view configurations.<a href="#section-3.3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1.3-2">Two examples from the <a href="https://qvis.edm.uhasselt.be">qvis toolset</a> are shown in
<a href="#qvis-config" class="auto internal xref">Figure 12</a>.<a href="#section-3.3.1.3-2" class="pilcrow">¶</a></p>
<span id="name-custom-configuration-fields"></span><div id="qvis-config">
<figure id="figure-12">
              <div class="alignLeft art-text artwork" id="section-3.3.1.3-3.1">
<pre>
{
    "configuration" : {
        "qvis" : {
            "congestion_graph": {
                "startX": 1000,
                "endX": 2000,
                "focusOnEventIndex": 124
            }

            "sequence_diagram" : {
                "focusOnEventIndex": 555
            }
        }
    }
}
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-custom-configuration-fields" class="selfRef">Custom configuration fields example</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="vantage-point">
<section id="section-3.3.2">
          <h4 id="name-vantage_point">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-vantage_point" class="section-name selfRef">vantage_point</a>
          </h4>
<p id="section-3.3.2-1">The vantage_point field describes the vantage point from which the trace
originates, see <a href="#vantage-point-def" class="auto internal xref">Figure 13</a>. Each trace can have only a single vantage_point
and thus all events in a trace <span class="bcp14">MUST</span> BE from the perspective of this vantage_point.
To include events from multiple vantage_points, implementers can for example
include multiple traces, split by vantage_point, in a single qlog file.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">Definitions:<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
<span id="name-vantagepoint-definition"></span><div id="vantage-point-def">
<figure id="figure-13">
            <div class="lang-cddl sourcecode" id="section-3.3.2-3.1">
<pre>
VantagePoint = {
    ? name: text
    type: VantagePointType
    ? flow: VantagePointType
}

; client = endpoint which initiates the connection
; server = endpoint which accepts the connection
; network = observer in between client and server
VantagePointType = "client" / "server" / "network" / "unknown"
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-vantagepoint-definition" class="selfRef">VantagePoint definition</a>
            </figcaption></figure>
</div>
<p id="section-3.3.2-4">JSON serialization examples:<a href="#section-3.3.2-4" class="pilcrow">¶</a></p>
<span id="name-vantagepoint-example"></span><div id="vantage-point-ex">
<figure id="figure-14">
            <div class="alignLeft art-text artwork" id="section-3.3.2-5.1">
<pre>
{
    "name": "aioquic client",
    "type": "client"
}

{
    "name": "wireshark trace",
    "type": "network",
    "flow": "client"
}
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-vantagepoint-example" class="selfRef">VantagePoint example</a>
            </figcaption></figure>
</div>
<p id="section-3.3.2-6">The flow field is only required if the type is "network" (for example, the trace
is generated from a packet capture). It is used to disambiguate events like
"packet sent" and "packet received". This is indicated explicitly because for
multiple reasons (e.g., privacy) data from which the flow direction can be
otherwise inferred (e.g., IP addresses) might not be present in the logs.<a href="#section-3.3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.3.2-7">Meaning of the different values for the flow field:
  * "client" indicates that this vantage point follows client data flow semantics (a
    "packet sent" event goes in the direction of the server).
  * "server" indicates that this vantage point follow server data flow semantics (a
    "packet sent" event goes in the direction of the client).
  * "unknown" indicates that the flow's direction is unknown.<a href="#section-3.3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.3.2-8">Depending on the context, tools confronted with "unknown" values in the
vantage_point can either try to heuristically infer the semantics from
protocol-level domain knowledge (e.g., in QUIC, the client always sends the first
packet) or give the user the option to switch between client and server
perspectives manually.<a href="#section-3.3.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="field-name-semantics">
<section id="section-3.4">
        <h3 id="name-field-name-semantics">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-field-name-semantics" class="section-name selfRef">Field name semantics</a>
        </h3>
<p id="section-3.4-1">Inside of the "events" field of a qlog trace is a list of events logged by the
endpoint. Each event is specified as a generic object with a number of member
fields and their associated data. Depending on the protocol and use case, the
exact member field names and their formats can differ across implementations. This
section lists the main, pre-defined and reserved field names with specific
semantics and expected corresponding value formats.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">Each qlog event at minimum requires the "time" (<a href="#time-based-fields" class="auto internal xref">Section 3.4.1</a>), "name"
(<a href="#name-field" class="auto internal xref">Section 3.4.2</a>) and "data" (<a href="#data-field" class="auto internal xref">Section 3.4.3</a>) fields. Other typical fields are
"time_format" (<a href="#time-based-fields" class="auto internal xref">Section 3.4.1</a>), "protocol_type" (<a href="#protocol-type-field" class="auto internal xref">Section 3.4.4</a>),
"trigger" (<a href="#trigger-field" class="auto internal xref">Section 3.4.5</a>), and "group_id" <a href="#group-ids" class="auto internal xref">Section 3.4.6</a>. As especially these
later fields typically have identical values across individual event instances,
they are normally logged separately in the "common_fields" (<a href="#common-fields" class="auto internal xref">Section 3.4.7</a>).<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">The specific values for each of these fields and their semantics are defined in
separate documents, specific per protocol or use case. For example: event
definitions for QUIC, HTTP/3 and QPACK can be found in <span>[<a href="#QLOG-QUIC" class="cite xref">QLOG-QUIC</a>]</span> and
<span>[<a href="#QLOG-H3" class="cite xref">QLOG-H3</a>]</span>.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">Other fields are explicitly allowed by the qlog approach, and tools <span class="bcp14">SHOULD</span> allow
for the presence of unknown event fields, but their semantics depend on the
context of the log usage (e.g., for QUIC, the ODCID field is used), see
<span>[<a href="#QLOG-QUIC" class="cite xref">QLOG-QUIC</a>]</span>.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">An example of a qlog event with its component fields is shown in
<a href="#event-def" class="auto internal xref">Figure 15</a>.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<p id="section-3.4-6">Definition:<a href="#section-3.4-6" class="pilcrow">¶</a></p>
<span id="name-event-definition"></span><div id="event-def">
<figure id="figure-15">
          <div class="lang-cddl sourcecode" id="section-3.4-7.1">
<pre>
Event = {
    time: float64
    name: text
    data: $ProtocolEventBody

    ? time_format: TimeFormat

    ? protocol_type: ProtocolType
    ? group_id: GroupID

    ; events can contain any amount of custom fields
    * text =&gt; any
}
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-event-definition" class="selfRef">Event definition</a>
          </figcaption></figure>
</div>
<p id="section-3.4-8">JSON serialization:<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<span id="name-event-example"></span><div id="event-ex">
<figure id="figure-16">
          <div class="alignLeft art-text artwork" id="section-3.4-9.1">
<pre>
{
    "time": 1553986553572,

    "name": "transport:packet_sent",
    "data": { ... },

    "protocol_type":  ["QUIC","HTTP3"],
    "group_id": "127ecc830d98f9d54a42c4f0842aa87e181a",

    "time_format": "absolute",

    "ODCID": "127ecc830d98f9d54a42c4f0842aa87e181a"
}
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-event-example" class="selfRef">Event example</a>
          </figcaption></figure>
</div>
<div id="time-based-fields">
<section id="section-3.4.1">
          <h4 id="name-timestamps">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-timestamps" class="section-name selfRef">Timestamps</a>
          </h4>
<p id="section-3.4.1-1">Each event <span class="bcp14">MUST</span> include a "time" field to indicate the timestamp that it
occurred. The format of the value is governed by the TimeFormat, which <span class="bcp14">MAY</span> be
included in the "time_format" field.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2">There is no requirement that events in the same trace use the same time format.
However, using a single time format for related events can make them easier to
analyze.<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
<p id="section-3.4.1-3">Definition:<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
<span id="name-timeformat-definition"></span><div id="time-format-def">
<figure id="figure-17">
            <div class="lang-cddl sourcecode" id="section-3.4.1-4.1">
<pre>
TimeFormat = "absolute" /
             "delta" /
             "relative" /
             "monotonic" .default "absolute"
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-timeformat-definition" class="selfRef">TimeFormat definition</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.4.1-5">
            <dt id="section-3.4.1-5.1">absolute:</dt>
            <dd style="margin-left: 1.5em" id="section-3.4.1-5.2">
              <p id="section-3.4.1-5.2.1">A full absolute timestamp. This approach uses the
largest amount of characters. This is the default value of the "time_format"
field.<a href="#section-3.4.1-5.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.4.1-5.3">delta:</dt>
            <dd style="margin-left: 1.5em" id="section-3.4.1-5.4">
              <p id="section-3.4.1-5.4.1">A delta-encoded value, based on the previously logged value. The first event
in a trace typically logs the full absolute timestamp. This approach uses the
least amount of characters.<a href="#section-3.4.1-5.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.4.1-5.5">relative:</dt>
            <dd style="margin-left: 1.5em" id="section-3.4.1-5.6">
              <p id="section-3.4.1-5.6.1">A relative timestamp based on some relative time base.  The log <span class="bcp14">SHOULD</span> specify
a "reference_time" timestamp, either by providing it explicitly in the
"reference_time" field in "common_fields" (<a href="#common-fields" class="auto internal xref">Section 3.4.7</a>) or logging an
absolute time in the first event. This approach uses a medium amount of
characters.<a href="#section-3.4.1-5.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.4.1-5.7">monotonic:</dt>
            <dd style="margin-left: 1.5em" id="section-3.4.1-5.8">
              <p id="section-3.4.1-5.8.1">A relative timestamp based on an opaque monotonically nondecreasing clock.
The "reference_time" field <span class="bcp14">MUST NOT</span> be applied to this format, since monotonic
time is measured against an opaque clock that cannot be interpreted beyond the system that
instantiated it.<a href="#section-3.4.1-5.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.4.1-6">Events in each individual trace <span class="bcp14">SHOULD</span> be logged in strictly ascending timestamp
order (though not necessarily absolute value, for the "delta" format). Tools CAN
sort all events on the timestamp before processing them, though are not required
to (as this could impose a significant processing overhead). This can be a problem
especially for multi-threaded and/or streaming loggers, who could consider using a
separate post-processor to order qlog events in time if a tool do not provide this
feature.<a href="#section-3.4.1-6" class="pilcrow">¶</a></p>
<p id="section-3.4.1-7">There is no default base clock for formats that rely on a shareable clock. Tools
<span class="bcp14">SHOULD NOT</span> assume the ability to derive the absolute Unix timestamp from qlog
traces. Tools should not rely on timestamps to be consistent across traces, even
those generated by the same logging endpoint. For reasons of privacy, a more
privacy-preserving reference timestamp could be chosen.<a href="#section-3.4.1-7" class="pilcrow">¶</a></p>
<p id="section-3.4.1-8">The "absolute" format is good for stateless loggers. The other formats suit
stateful loggers.<a href="#section-3.4.1-8" class="pilcrow">¶</a></p>
<p id="section-3.4.1-9">Formats that use smaller values can produce smaller-sized file and can be easier
to reason about during analysis. An example for each option can be seen in
<a href="#time-format-ex" class="auto internal xref">Figure 18</a>.<a href="#section-3.4.1-9" class="pilcrow">¶</a></p>
<span id="name-three-different-approaches-"></span><div id="time-format-ex">
<figure id="figure-18">
            <div class="alignLeft art-text artwork" id="section-3.4.1-10.1">
<pre>
Example "absolute" TimeFormat values:
1500, 1505, 1522, 1588

Example "delta" TimeFormat values:
1500, 5, 17, 66

Example "reference" TimeFormat values, assuming a reference_time of 1500
in "common_fields":
0, 5, 22, 88

Example "monotonic" TimeFormat values:
0, 5, 22, 88
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-three-different-approaches-" class="selfRef">Three different approaches for logging timestamps</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="name-field">
<section id="section-3.4.2">
          <h4 id="name-category-and-event-type">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-category-and-event-type" class="section-name selfRef">Category and Event Type</a>
          </h4>
<p id="section-3.4.2-1">Events differ mainly in the type of metadata associated with them. To help
identify a given event and how to interpret its metadata in the "data" field (see
<a href="#data-field" class="auto internal xref">Section 3.4.3</a>), each event has an associated "name" field. This can be considered
as a concatenation of two other fields, namely event "category" and event "type".<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2-2">Category allows a higher-level grouping of events per specific event type. For
example for QUIC and HTTP/3, the different categories could be "transport",
"http", "qpack", and "recovery". Within these categories, the event Type provides
additional granularity. For example for QUIC and HTTP/3, within the "transport"
Category, there would be "packet_sent" and "packet_received" events.<a href="#section-3.4.2-2" class="pilcrow">¶</a></p>
<p id="section-3.4.2-3">Logging category and type separately conceptually allows for fast and high-level
filtering based on category and the re-use of event types across categories.
However, it also considerably inflates the log size and this flexibility is not
used extensively in practice at the time of writing.<a href="#section-3.4.2-3" class="pilcrow">¶</a></p>
<p id="section-3.4.2-4">As such, the default approach in qlog is to concatenate both field values using
the ":" character in the "name" field, as can be seen in <a href="#name-ex" class="auto internal xref">Figure 19</a>. As
such, qlog category and type names <span class="bcp14">MUST NOT</span> include this character.<a href="#section-3.4.2-4" class="pilcrow">¶</a></p>
<span id="name-ways-of-logging-category-ty"></span><div id="name-ex">
<figure id="figure-19">
            <div class="alignLeft art-text artwork" id="section-3.4.2-5.1">
<pre>
JSON serialization using separate fields:
{
    "category": "transport",
    "type": "packet_sent"
}

JSON serialization using ":" concatenated field:
{
    "name": "transport:packet_sent"
}
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-ways-of-logging-category-ty" class="selfRef">Ways of logging category, type and name of an event.</a>
            </figcaption></figure>
</div>
<p id="section-3.4.2-6">Certain serializations CAN emit category and type as separate fields, and qlog
tools <span class="bcp14">SHOULD</span> be able to deal with both the concatenated "name" field, and the
separate "category" and "type" fields. Text-based serializations however are
encouraged to employ the concatenated "name" field for efficiency.<a href="#section-3.4.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="data-field">
<section id="section-3.4.3">
          <h4 id="name-data">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-data" class="section-name selfRef">Data</a>
          </h4>
<p id="section-3.4.3-1">The data field is a generic object. It contains the per-event metadata and its
form and semantics are defined per specific sort of event. For example, data
field value definitions for QUIC and HTTP/3 can be found in <span>[<a href="#QLOG-QUIC" class="cite xref">QLOG-QUIC</a>]</span> and
<span>[<a href="#QLOG-H3" class="cite xref">QLOG-H3</a>]</span>.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.3-2">This field is defined here as a CDDL extension point (a "socket" or
"plug") named <code>$ProtocolEventBody</code>. Other documents <span class="bcp14">MUST</span> properly extend
this extension point when defining new data field content options to
enable automated validation of aggregated qlog schemas.<a href="#section-3.4.3-2" class="pilcrow">¶</a></p>
<p id="section-3.4.3-3">The only common field defined for the data field is the <code>trigger</code> field,
which is discussed in <a href="#trigger-field" class="auto internal xref">Section 3.4.5</a>.<a href="#section-3.4.3-3" class="pilcrow">¶</a></p>
<p id="section-3.4.3-4">Definition:<a href="#section-3.4.3-4" class="pilcrow">¶</a></p>
<span id="name-protocoleventbody-definitio"></span><div id="protocoleventbody-def">
<figure id="figure-20">
            <div class="lang-cddl sourcecode" id="section-3.4.3-5.1">
<pre>
; The ProtocolEventBody is any key-value map (e.g., JSON object)
; only the optional trigger field is defined in this document
$ProtocolEventBody /= {
    ? trigger: text
    * text =&gt; any
}
; event documents are intended to extend this socket by using:
; NewProtocolEvents = EventType1 / EventType2 / ... / EventTypeN
; $ProtocolEventBody /= NewProtocolEvents
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-protocoleventbody-definitio" class="selfRef">ProtocolEventBody definition</a>
            </figcaption></figure>
</div>
<p id="section-3.4.3-6">One purely illustrative example for a QUIC "packet_sent" event is shown in
<a href="#data-ex" class="auto internal xref">Figure 21</a>:<a href="#section-3.4.3-6" class="pilcrow">¶</a></p>
<span id="name-example-of-the-data-field-f"></span><div id="data-ex">
<figure id="figure-21">
            <div class="alignLeft art-text artwork" id="section-3.4.3-7.1">
<pre>
TransportPacketSent = {
    ? packet_size: uint16
    header: PacketHeader
    ? frames:[* QuicFrame]
    ? trigger: "pto_probe" / "retransmit_timeout" / "bandwidth_probe"
}

could be serialized as

{
    "packet_size": 1280,
    "header": {
        "packet_type": "1RTT",
        "packet_number": 123
    },
    "frames": [
        {
            "frame_type": "stream",
            "length": 1000,
            "offset": 456
        },
        {
            "frame_type": "padding"
        }
    ]
}
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-example-of-the-data-field-f" class="selfRef">Example of the 'data' field for a QUIC packet_sent event</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="protocol-type-field">
<section id="section-3.4.4">
          <h4 id="name-protocol_type">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-protocol_type" class="section-name selfRef">protocol_type</a>
          </h4>
<p id="section-3.4.4-1">The "protocol_type" array field indicates to which protocols (or protocol
"stacks") this event belongs. This allows a single qlog file to aggregate traces
of different protocols (e.g., a web server offering both TCP+HTTP/2 and
QUIC+HTTP/3 connections).<a href="#section-3.4.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4.4-2">Definition:<a href="#section-3.4.4-2" class="pilcrow">¶</a></p>
<span id="name-protocoltype-definition"></span><div id="protocol-type-def">
<figure id="figure-22">
            <div class="lang-cddl sourcecode" id="section-3.4.4-3.1">
<pre>
ProtocolType = [+ text]
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-protocoltype-definition" class="selfRef">ProtocolType definition</a>
            </figcaption></figure>
</div>
<p id="section-3.4.4-4">For example, QUIC and HTTP/3 events have the "QUIC" and "HTTP3" protocol_type
entry values, see <span>[<a href="#QLOG-QUIC" class="cite xref">QLOG-QUIC</a>]</span> and <span>[<a href="#QLOG-H3" class="cite xref">QLOG-H3</a>]</span>.<a href="#section-3.4.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4.4-5">Typically however, all events in a single trace are of the same few protocols, and
this array field is logged once in "common_fields", see <a href="#common-fields" class="auto internal xref">Section 3.4.7</a>.<a href="#section-3.4.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trigger-field">
<section id="section-3.4.5">
          <h4 id="name-triggers">
<a href="#section-3.4.5" class="section-number selfRef">3.4.5. </a><a href="#name-triggers" class="section-name selfRef">Triggers</a>
          </h4>
<p id="section-3.4.5-1">Sometimes, additional information is needed in the case where a single event can
be caused by a variety of other events. In the normal case, the context of the
surrounding log messages gives a hint as to which of these other events was the
cause. However, in highly-parallel and optimized implementations, corresponding
log messages might separated in time. Another option is to explicitly indicate
these "triggers" in a high-level way per-event to get more fine-grained
information without much additional overhead.<a href="#section-3.4.5-1" class="pilcrow">¶</a></p>
<p id="section-3.4.5-2">In qlog, the optional "trigger" field contains a string value describing
the reason (if any) for this event instance occurring, see
<a href="#data-field" class="auto internal xref">Section 3.4.3</a>. While this "trigger" field could be a property of the
qlog Event itself, it is instead a property of the "data" field instead.
This choice was made because many event types do not include a trigger
value, and having the field at the Event-level would cause overhead in
some serializations. Additional information on the trigger can be added
in the form of additional member fields of the "data" field value, yet
this is highly implementation-specific, as are the trigger field's
string values.<a href="#section-3.4.5-2" class="pilcrow">¶</a></p>
<p id="section-3.4.5-3">One purely illustrative example of some potential triggers for QUIC's
"packet_dropped" event is shown in <a href="#trigger-ex" class="auto internal xref">Figure 23</a>:<a href="#section-3.4.5-3" class="pilcrow">¶</a></p>
<span id="name-trigger-example"></span><div id="trigger-ex">
<figure id="figure-23">
            <div class="alignLeft art-text artwork" id="section-3.4.5-4.1">
<pre>
TransportPacketDropped = {
    ? packet_type: PacketType
    ? raw_length: uint16

    ? trigger: "key_unavailable" / "unknown_connection_id" /
               "decrypt_error" / "unsupported_version"
}
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-trigger-example" class="selfRef">Trigger example</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="group-ids">
<section id="section-3.4.6">
          <h4 id="name-group_id">
<a href="#section-3.4.6" class="section-number selfRef">3.4.6. </a><a href="#name-group_id" class="section-name selfRef">group_id</a>
          </h4>
<p id="section-3.4.6-1">As discussed in <a href="#trace" class="auto internal xref">Section 3.3</a>, a single qlog file can contain several traces taken
from different vantage points. However, a single trace from one endpoint can also
contain events from a variety of sources. For example, a server implementation
might choose to log events for all incoming connections in a single large
(streamed) qlog file. As such, we need a method for splitting up events belonging
to separate logical entities.<a href="#section-3.4.6-1" class="pilcrow">¶</a></p>
<p id="section-3.4.6-2">The simplest way to perform this splitting is by associating a "group identifier"
to each event that indicates to which conceptual "group" each event belongs. A
post-processing step can then extract events per group. However, this group
identifier can be highly protocol and context-specific. In the example above, we
might use QUIC's "Original Destination Connection ID" to uniquely identify a
connection. As such, they might add a "ODCID" field to each event. However, a
middlebox logging IP or TCP traffic might rather use four-tuples to identify
connections, and add a "four_tuple" field.<a href="#section-3.4.6-2" class="pilcrow">¶</a></p>
<p id="section-3.4.6-3">As such, to provide consistency and ease of tooling in cross-protocol and
cross-context setups, qlog instead defines the common "group_id" field, which
contains a string value. Implementations are free to use their preferred string
serialization for this field, so long as it contains a unique value per logical
group. Some examples can be seen in <a href="#group-id-ex" class="auto internal xref">Figure 25</a>.<a href="#section-3.4.6-3" class="pilcrow">¶</a></p>
<p id="section-3.4.6-4">Definition:<a href="#section-3.4.6-4" class="pilcrow">¶</a></p>
<span id="name-groupid-definition"></span><div id="group-id-def">
<figure id="figure-24">
            <div class="lang-cddl sourcecode" id="section-3.4.6-5.1">
<pre>
GroupID = text
</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-groupid-definition" class="selfRef">GroupID definition</a>
            </figcaption></figure>
</div>
<p id="section-3.4.6-6">JSON serialization example for events grouped by four tuples
and QUIC connection IDs:<a href="#section-3.4.6-6" class="pilcrow">¶</a></p>
<span id="name-groupid-example"></span><div id="group-id-ex">
<figure id="figure-25">
            <div class="alignLeft art-text artwork" id="section-3.4.6-7.1">
<pre>
"events": [
    {
        "time": 1553986553579,
        "protocol_type": ["TCP", "TLS", "HTTP2"],
        "group_id": "ip1=2001:67c:1232:144:9498:6df6:f450:110b,
                   ip2=2001:67c:2b0:1c1::198,port1=59105,port2=80",
        "name": "transport:packet_received",
        "data": { ... }
    },
    {
        "time": 1553986553581,
        "protocol_type": ["QUIC","HTTP3"],
        "group_id": "127ecc830d98f9d54a42c4f0842aa87e181a",
        "name": "transport:packet_sent",
        "data": { ... }
    }
]
</pre>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-groupid-example" class="selfRef">GroupID example</a>
            </figcaption></figure>
</div>
<p id="section-3.4.6-8">Note that in some contexts (for example a Multipath transport protocol) it might
make sense to add additional contextual per-event fields (for example "path_id"),
rather than use the group_id field for that purpose.<a href="#section-3.4.6-8" class="pilcrow">¶</a></p>
<p id="section-3.4.6-9">Note also that, typically, a single trace only contains events belonging to a
single logical group (for example, an individual QUIC connection). As such,
instead of logging the "group_id" field with an identical value for each event
instance, this field is typically logged once in "common_fields", see
<a href="#common-fields" class="auto internal xref">Section 3.4.7</a>.<a href="#section-3.4.6-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="common-fields">
<section id="section-3.4.7">
          <h4 id="name-common_fields">
<a href="#section-3.4.7" class="section-number selfRef">3.4.7. </a><a href="#name-common_fields" class="section-name selfRef">common_fields</a>
          </h4>
<p id="section-3.4.7-1">As discussed in the previous sections, information for a typical qlog event varies
in three main fields: "time", "name" and associated data. Additionally, there are
also several more advanced fields that allow mixing events from different
protocols and contexts inside of the same trace (for example "protocol_type" and
"group_id"). In most "normal" use cases however, the values of these advanced
fields are consistent for each event instance (for example, a single trace
contains events for a single QUIC connection).<a href="#section-3.4.7-1" class="pilcrow">¶</a></p>
<p id="section-3.4.7-2">To reduce file size and making logging easier, qlog uses the "common_fields" list
to indicate those fields and their values that are shared by all events in this
component trace. This prevents these fields from being logged for each individual
event. An example of this is shown in <a href="#common-fields-ex" class="auto internal xref">Figure 26</a>.<a href="#section-3.4.7-2" class="pilcrow">¶</a></p>
<span id="name-commonfields-example"></span><div id="common-fields-ex">
<figure id="figure-26">
            <div class="alignLeft art-text artwork" id="section-3.4.7-3.1">
<pre>
JSON serialization with repeated field values
per-event instance:

{
    "events": [{
            "group_id": "127ecc830d98f9d54a42c4f0842aa87e181a",
            "protocol_type": ["QUIC","HTTP3"],
            "time_format": "relative",
            "reference_time": 1553986553572,

            "time": 2,
            "name": "transport:packet_received",
            "data": { ... }
        },{
            "group_id": "127ecc830d98f9d54a42c4f0842aa87e181a",
            "protocol_type": ["QUIC","HTTP3"],
            "time_format": "relative",
            "reference_time": 1553986553572,

            "time": 7,
            "name": "http:frame_parsed",
            "data": { ... }
        }
    ]
}

JSON serialization with repeated field values instead
extracted to common_fields:

{
    "common_fields": {
        "group_id": "127ecc830d98f9d54a42c4f0842aa87e181a",
        "protocol_type": ["QUIC","HTTP3"],
        "time_format": "relative",
        "reference_time": 1553986553572
    },
    "events": [
        {
            "time": 2,
            "name": "transport:packet_received",
            "data": { ... }
        },{
            "time": 7,
            "name": "http:frame_parsed",
            "data": { ... }
        }
    ]
}
</pre>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-commonfields-example" class="selfRef">CommonFields example</a>
            </figcaption></figure>
</div>
<p id="section-3.4.7-4">The "common_fields" field is a generic dictionary of key-value pairs, where the
key is always a string and the value can be of any type, but is typically also a
string or number. As such, unknown entries in this dictionary <span class="bcp14">MUST</span> be disregarded
by the user and tools (i.e., the presence of an unknown field is explicitly NOT an
error).<a href="#section-3.4.7-4" class="pilcrow">¶</a></p>
<p id="section-3.4.7-5">The list of default qlog fields that are typically logged in common_fields (as
opposed to as individual fields per event instance) are shown in the listing
below:<a href="#section-3.4.7-5" class="pilcrow">¶</a></p>
<p id="section-3.4.7-6">Definition:<a href="#section-3.4.7-6" class="pilcrow">¶</a></p>
<span id="name-commonfields-definition"></span><div id="common-fields-def">
<figure id="figure-27">
            <div class="lang-cddl sourcecode" id="section-3.4.7-7.1">
<pre>
CommonFields = {
    ? time_format: TimeFormat
    ? reference_time: float64

    ? protocol_type: ProtocolType
    ? group_id: GroupID

    * text =&gt; any
}
</pre>
</div>
<figcaption><a href="#figure-27" class="selfRef">Figure 27</a>:
<a href="#name-commonfields-definition" class="selfRef">CommonFields definition</a>
            </figcaption></figure>
</div>
<p id="section-3.4.7-8">Tools <span class="bcp14">MUST</span> be able to deal with these fields being defined either on each event
individually or combined in common_fields. Note that if at least one event in a
trace has a different value for a given field, this field <span class="bcp14">MUST NOT</span> be added to
common_fields but instead defined on each event individually. Good example of such
fields are "time" and "data", who are divergent by nature.<a href="#section-3.4.7-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="guidelines-for-event-definition-documents">
<section id="section-4">
      <h2 id="name-guidelines-for-event-defini">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-guidelines-for-event-defini" class="section-name selfRef">Guidelines for event definition documents</a>
      </h2>
<p id="section-4-1">This document only defines the main schema for the qlog format. This is intended
to be used together with specific, per-protocol event definitions that specify the
name (category + type) and data needed for each individual event. This is with the
intent to allow the qlog main schema to be easily re-used for several protocols.
Examples include the QUIC event definitions <span>[<a href="#QLOG-QUIC" class="cite xref">QLOG-QUIC</a>]</span> and HTTP/3 and QPACK
event definitions <span>[<a href="#QLOG-H3" class="cite xref">QLOG-H3</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">This section defines some basic annotations and concepts the creators of event
definition documents <span class="bcp14">SHOULD</span> follow to ensure a measure of consistency, making it
easier for qlog implementers to extrapolate from one protocol to another.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="event-design-guidelines">
<section id="section-4.1">
        <h3 id="name-event-design-guidelines">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-event-design-guidelines" class="section-name selfRef">Event design guidelines</a>
        </h3>
<p id="section-4.1-1">TODO: pending QUIC working group discussion. This text reflects the initial (qlog
draft 01 and 02) setup.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">There are several ways of defining qlog events. In practice, we have seen two main
types used so far: a) those that map directly to concepts seen in the protocols
(e.g., <code>packet_sent</code>) and b) those that act as aggregating events that combine
data from several possible protocol behaviors or code paths into one (e.g.,
<code>parameters_set</code>). The latter are typically used as a means to reduce the amount
of unique event definitions, as reflecting each possible protocol event as a
separate qlog entity would cause an explosion of event types.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Additionally, logging duplicate data is typically prevented as much as possible.
For example, packet header values that remain consistent across many packets are
split into separate events (for example <code>spin_bit_updated</code> or
<code>connection_id_updated</code> for QUIC).<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">Finally, we have typically refrained from adding additional state change events if
those state changes can be directly inferred from data on the wire (for example
flow control limit changes) if the implementation is bug-free and spec-compliant.
Exceptions have been made for common events that benefit from being easily
identifiable or individually logged (for example <code>packets_acked</code>).<a href="#section-4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="event-importance-indicators">
<section id="section-4.2">
        <h3 id="name-event-importance-indicators">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-event-importance-indicators" class="section-name selfRef">Event importance indicators</a>
        </h3>
<p id="section-4.2-1">Depending on how events are designed, it may be that several events allow the
logging of similar or overlapping data. For example the separate QUIC
<code>connection_started</code> event overlaps with the more generic
<code>connection_state_updated</code>. In these cases, it is not always clear which event
should be logged or used, and which event should take precedence if e.g., both are
present and provide conflicting information.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">To aid in this decision making, we recommend that each event <span class="bcp14">SHOULD</span> have an
"importance indicator" with one of three values, in decreasing order of importance
and expected usage:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-3.1">Core<a href="#section-4.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-3.2">Base<a href="#section-4.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-3.3">Extra<a href="#section-4.2-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-4">The "Core" events are the events that <span class="bcp14">SHOULD</span> be present in all qlog files for a
given protocol. These are typically tied to basic packet and frame parsing and
creation, as well as listing basic internal metrics. Tool implementers <span class="bcp14">SHOULD</span>
expect and add support for these events, though <span class="bcp14">SHOULD NOT</span> expect all Core events
to be present in each qlog trace.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">The "Base" events add additional debugging options and CAN be present in qlog
files. Most of these can be implicitly inferred from data in Core events (if those
contain all their properties), but for many it is better to log the events
explicitly as well, making it clearer how the implementation behaves. These events
are for example tied to passing data around in buffers, to how internal state
machines change and help show when decisions are actually made based on received
data. Tool implementers <span class="bcp14">SHOULD</span> at least add support for showing the contents of
these events, if they do not handle them explicitly.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">The "Extra" events are considered mostly useful for low-level debugging of the
implementation, rather than the protocol. They allow more fine-grained tracking of
internal behavior. As such, they CAN be present in qlog files and tool
implementers CAN add support for these, but they are not required to.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">Note that in some cases, implementers might not want to log for example data
content details in the "Core" events due to performance or privacy considerations.
In this case, they <span class="bcp14">SHOULD</span> use (a subset of) relevant "Base" events instead to
ensure usability of the qlog output. As an example, implementations that do not
log QUIC <code>packet_received</code> events and thus also not which (if any) ACK frames the
packet contains, <span class="bcp14">SHOULD</span> log <code>packets_acked</code> events instead.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2-8">Finally, for event types whose data (partially) overlap with other event types'
definitions, where necessary the event definition document should include explicit
guidance on which to use in specific situations.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="custom-fields-1">
<section id="section-4.3">
        <h3 id="name-custom-fields-2">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-custom-fields-2" class="section-name selfRef">Custom fields</a>
        </h3>
<p id="section-4.3-1">Event definition documents are free to define new category and event types,
top-level fields (e.g., a per-event field indicating its privacy properties or
path_id in multipath protocols), as well as values for the "trigger" property
within the "data" field, or other member fields of the "data" field, as they see
fit.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">They however <span class="bcp14">SHOULD NOT</span> expect non-specialized tools to recognize or visualize
this custom data. However, tools <span class="bcp14">SHOULD</span> make an effort to visualize even unknown
data if possible in the specific tool's context. If they do not, they <span class="bcp14">MUST</span> ignore
these unknown fields.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="generic-events-and-data-classes">
<section id="section-5">
      <h2 id="name-generic-events-and-data-cla">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-generic-events-and-data-cla" class="section-name selfRef">Generic events and data classes</a>
      </h2>
<p id="section-5-1">There are some event types and data classes that are common across protocols,
applications and use cases that benefit from being defined in a single location.
This section specifies such common definitions.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="raw-info">
<section id="section-5.1">
        <h3 id="name-raw-packet-and-frame-inform">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-raw-packet-and-frame-inform" class="section-name selfRef">Raw packet and frame information</a>
        </h3>
<p id="section-5.1-1">While qlog is a high-level logging format, it also allows the inclusion of most
raw wire image information, such as byte lengths and byte values. This is useful
when for example investigating or tuning packetization behavior or determining
encoding/framing overheads. However, these fields are not always necessary, can
take up considerable space, and can have a considerable privacy and security
impact (see <a href="#privacy" class="auto internal xref">Section 9</a>). Where applicable, these fields are grouped in a
separate, optional, field named "raw" of type RawInfo. The exact definition of
entities, headers, trailers and payloads depend on the protocol used.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Definition:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<span id="name-rawinfo-definition"></span><div id="raw-info-def">
<figure id="figure-28">
          <div class="lang-cddl sourcecode" id="section-5.1-3.1">
<pre>
RawInfo = {
    ; the full byte length of the entity (e.g., packet or frame),
    ; including possible headers and trailers
    ? length: uint64

    ; the byte length of the entity's payload,
    ; excluding possible headers or trailers
    ? payload_length: uint64

    ; the (potentially truncated) contents of the full entity,
    ; including headers and possibly trailers
    ? data: hexstring
}
</pre>
</div>
<figcaption><a href="#figure-28" class="selfRef">Figure 28</a>:
<a href="#name-rawinfo-definition" class="selfRef">RawInfo definition</a>
          </figcaption></figure>
</div>
<p id="section-5.1-4">The RawInfo:data field can be truncated for privacy or security purposes, see
<a href="#truncated-values" class="auto internal xref">Section 6.1.2</a>. In this case, the length and payload_length fields should
still indicate the non-truncated lengths when used for debugging purposes.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">This document does not specify explicit header_length or trailer_length fields.
In protocols without trailers, header_length can be calculated by subtracting
the payload_length from the length. In protocols with trailers (e.g., QUIC's
AEAD tag), event definition documents <span class="bcp14">SHOULD</span> define how to support header_length
calculation.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="generic-events">
<section id="section-5.2">
        <h3 id="name-generic-events">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-generic-events" class="section-name selfRef">Generic events</a>
        </h3>
<p id="section-5.2-1">In typical logging setups, users utilize a discrete number of well-defined logging
categories, levels or severities to log freeform (string) data. This generic
events category replicates this approach to allow implementations to fully replace
their existing text-based logging by qlog. This is done by providing events to log
generic strings for the typical well-known logging levels (error, warning, info,
debug, verbose).<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">For the events defined below, the "category" is "generic" and their "type" is the
name of the heading in lowercase (e.g., the "name" of the error event is
"generic:error").<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<div id="error">
<section id="section-5.2.1">
          <h4 id="name-error">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-error" class="section-name selfRef">error</a>
          </h4>
<p id="section-5.2.1-1">Importance: Core<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">Used to log details of an internal error that might not get reflected on the wire.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">Definition:<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<span id="name-genericerror-definition"></span><div id="generic-error-def">
<figure id="figure-29">
            <div class="lang-cddl sourcecode" id="section-5.2.1-4.1">
<pre>
GenericError = {
    ? code: uint64
    ? message: text
}
</pre>
</div>
<figcaption><a href="#figure-29" class="selfRef">Figure 29</a>:
<a href="#name-genericerror-definition" class="selfRef">GenericError definition</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="warning">
<section id="section-5.2.2">
          <h4 id="name-warning">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-warning" class="section-name selfRef">warning</a>
          </h4>
<p id="section-5.2.2-1">Importance: Base<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">Used to log details of an internal warning that might not get reflected on the
wire.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3">Definition:<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<span id="name-genericwarning-definition"></span><div id="generic-warning-def">
<figure id="figure-30">
            <div class="lang-cddl sourcecode" id="section-5.2.2-4.1">
<pre>
GenericWarning = {
    ? code: uint64
    ? message: text
}
</pre>
</div>
<figcaption><a href="#figure-30" class="selfRef">Figure 30</a>:
<a href="#name-genericwarning-definition" class="selfRef">GenericWarning definition</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="info">
<section id="section-5.2.3">
          <h4 id="name-info">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-info" class="section-name selfRef">info</a>
          </h4>
<p id="section-5.2.3-1">Importance: Extra<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3-2">Used mainly for implementations that want to use qlog as their one and only
logging format but still want to support unstructured string messages.<a href="#section-5.2.3-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3-3">Definition:<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
<span id="name-genericinfo-definition"></span><div id="generic-info-def">
<figure id="figure-31">
            <div class="lang-cddl sourcecode" id="section-5.2.3-4.1">
<pre>
GenericInfo = {
    message: text
}
</pre>
</div>
<figcaption><a href="#figure-31" class="selfRef">Figure 31</a>:
<a href="#name-genericinfo-definition" class="selfRef">GenericInfo definition</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="debug">
<section id="section-5.2.4">
          <h4 id="name-debug">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-debug" class="section-name selfRef">debug</a>
          </h4>
<p id="section-5.2.4-1">Importance: Extra<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
<p id="section-5.2.4-2">Used mainly for implementations that want to use qlog as their one and only
logging format but still want to support unstructured string messages.<a href="#section-5.2.4-2" class="pilcrow">¶</a></p>
<p id="section-5.2.4-3">Definition:<a href="#section-5.2.4-3" class="pilcrow">¶</a></p>
<span id="name-genericdebug-definition"></span><div id="generic-debug-def">
<figure id="figure-32">
            <div class="lang-cddl sourcecode" id="section-5.2.4-4.1">
<pre>
GenericDebug = {
    message: text
}
</pre>
</div>
<figcaption><a href="#figure-32" class="selfRef">Figure 32</a>:
<a href="#name-genericdebug-definition" class="selfRef">GenericDebug definition</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="verbose">
<section id="section-5.2.5">
          <h4 id="name-verbose">
<a href="#section-5.2.5" class="section-number selfRef">5.2.5. </a><a href="#name-verbose" class="section-name selfRef">verbose</a>
          </h4>
<p id="section-5.2.5-1">Importance: Extra<a href="#section-5.2.5-1" class="pilcrow">¶</a></p>
<p id="section-5.2.5-2">Used mainly for implementations that want to use qlog as their one and only
logging format but still want to support unstructured string messages.<a href="#section-5.2.5-2" class="pilcrow">¶</a></p>
<p id="section-5.2.5-3">Definition:<a href="#section-5.2.5-3" class="pilcrow">¶</a></p>
<span id="name-genericverbose-definition"></span><div id="generic-verbose-def">
<figure id="figure-33">
            <div class="lang-cddl sourcecode" id="section-5.2.5-4.1">
<pre>
GenericVerbose = {
    message: text
}
</pre>
</div>
<figcaption><a href="#figure-33" class="selfRef">Figure 33</a>:
<a href="#name-genericverbose-definition" class="selfRef">GenericVerbose definition</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="simulation-events">
<section id="section-5.3">
        <h3 id="name-simulation-events">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-simulation-events" class="section-name selfRef">Simulation events</a>
        </h3>
<p id="section-5.3-1">When evaluating a protocol implementation, one typically sets up a series of
interoperability or benchmarking tests, in which the test situations can change
over time. For example, the network bandwidth or latency can vary during the test,
or the network can be fully disable for a short time. In these setups, it is
useful to know when exactly these conditions are triggered, to allow for proper
correlation with other events.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">For the events defined below, the "category" is "simulation" and their "type" is
the name of the heading in lowercase (e.g., the "name" of the scenario event is
"simulation:scenario").<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<div id="scenario">
<section id="section-5.3.1">
          <h4 id="name-scenario">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-scenario" class="section-name selfRef">scenario</a>
          </h4>
<p id="section-5.3.1-1">Importance: Extra<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">Used to specify which specific scenario is being tested at this particular
instance. This could also be reflected in the top-level qlog's <code>summary</code> or
<code>configuration</code> fields, but having a separate event allows easier aggregation of
several simulations into one trace (e.g., split by <code>group_id</code>).<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
<p id="section-5.3.1-3">Definition:<a href="#section-5.3.1-3" class="pilcrow">¶</a></p>
<span id="name-simulationscenario-definiti"></span><div id="simulation-scenario-def">
<figure id="figure-34">
            <div class="lang-cddl sourcecode" id="section-5.3.1-4.1">
<pre>
SimulationScenario = {
    ? name: text
    ? details: {* text =&gt; any }
}
</pre>
</div>
<figcaption><a href="#figure-34" class="selfRef">Figure 34</a>:
<a href="#name-simulationscenario-definiti" class="selfRef">SimulationScenario definition</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="marker">
<section id="section-5.3.2">
          <h4 id="name-marker">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-marker" class="section-name selfRef">marker</a>
          </h4>
<p id="section-5.3.2-1">Importance: Extra<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2-2">Used to indicate when specific emulation conditions are triggered at set times
(e.g., at 3 seconds in 2% packet loss is introduced, at 10s a NAT rebind is
triggered).<a href="#section-5.3.2-2" class="pilcrow">¶</a></p>
<p id="section-5.3.2-3">Definition:<a href="#section-5.3.2-3" class="pilcrow">¶</a></p>
<span id="name-simulationmarker-definition"></span><div id="simulation-marker-def">
<figure id="figure-35">
            <div class="lang-cddl sourcecode" id="section-5.3.2-4.1">
<pre>
SimulationMarker = {
    ? type: text
    ? message: text
}
</pre>
</div>
<figcaption><a href="#figure-35" class="selfRef">Figure 35</a>:
<a href="#name-simulationmarker-definition" class="selfRef">SimulationMarker definition</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="concrete-formats">
<section id="section-6">
      <h2 id="name-serializing-qlog">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-serializing-qlog" class="section-name selfRef">Serializing qlog</a>
      </h2>
<p id="section-6-1">This document and other related qlog schema definitions are intentionally
serialization-format agnostic. This means that implementers themselves can choose
how to represent and serialize qlog data practically on disk or on the wire. Some
examples of possible formats are JSON, CBOR, CSV, protocol buffers, flatbuffers,
etc.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">All these formats make certain tradeoffs between flexibility and efficiency, with
textual formats like JSON typically being more flexible but also less efficient
than binary formats like protocol buffers. The format choice will depend on the
practical use case of the qlog user. For example, for use in day to day debugging,
a plaintext readable (yet relatively large) format like JSON is probably
preferred. However, for use in production, a more optimized yet restricted format
can be better. In this latter case, it will be more difficult to achieve
interoperability between qlog implementations of various protocol stacks, as some
custom or tweaked events from one might not be compatible with the format of the
other. This will also reflect in tooling: not all tools will support all formats.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">This being said, the authors prefer JSON as the basis for storing qlog,
as it retains full flexibility and maximum interoperability. Storage
overhead can be managed well in practice by employing compression. For
this reason, this document details how to practically transform qlog
schema definitions to <span>[<a href="#JSON" class="cite xref">JSON</a>]</span>, its subset <span>[<a href="#I-JSON" class="cite xref">I-JSON</a>]</span>,
and its streamable derivative <span>[<a href="#JSON-Text-Sequences" class="cite xref">JSON-Text-Sequences</a>]</span>s. We
discuss concrete options to bring down JSON size and processing
overheads in <a href="#optimizations" class="auto internal xref">Section 6.3</a>.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">As depending on the employed format different deserializers/parsers should be
used, the "qlog_format" field is used to indicate the chosen serialization
approach. This field is always a string, but can be made hierarchical by the use
of the "." separator between entries. For example, a value of "JSON.optimizationA"
can indicate that a default JSON format is being used, but that a certain
optimization of type A was applied to the file as well (see also
<a href="#optimizations" class="auto internal xref">Section 6.3</a>).<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="format-json">
<section id="section-6.1">
        <h3 id="name-qlog-to-json-mapping">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-qlog-to-json-mapping" class="section-name selfRef">qlog to JSON mapping</a>
        </h3>
<p id="section-6.1-1">When mapping qlog to normal JSON, the "qlog_format" field <span class="bcp14">MUST</span> have the value
"JSON". This is also the default qlog serialization and default value of this
field.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">When using normal JSON serialization, the file extension/suffix <span class="bcp14">SHOULD</span>
be ".qlog" and the Media Type (if any) <span class="bcp14">SHOULD</span> be "application/qlog+json"
per <span>[<a href="#RFC6839" class="cite xref">RFC6839</a>]</span>.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">JSON files by definition (<span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>) <span class="bcp14">MUST</span> utilize the UTF-8 encoding,
both for the file itself and the string values.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">While not specifically required by the JSON specification, all qlog field
names in a JSON serialization <span class="bcp14">MUST</span> be lowercase.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">In order to serialize CDDL-based qlog event and data structure
definitions to JSON, the official CDDL-to-JSON mapping defined in
Appendix E of <span>[<a href="#CDDL" class="cite xref">CDDL</a>]</span> <span class="bcp14">SHOULD</span> be employed.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<div id="i-json">
<section id="section-6.1.1">
          <h4 id="name-i-json">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-i-json" class="section-name selfRef">I-JSON</a>
          </h4>
<p id="section-6.1.1-1">For some use cases, it should be taken into account that not all popular
JSON parsers support the full JSON format. Especially for parsers
integrated with the JavaScript programming language (e.g., Web browsers,
NodeJS), users are recommended to stick to a JSON subset dubbed
<span>[<a href="#I-JSON" class="cite xref">I-JSON</a>]</span> (or Internet-JSON).<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">One of the key limitations of JavaScript and thus I-JSON is that it
cannot represent full 64-bit integers in standard operating mode (i.e.,
without using BigInt extensions), instead being limited to the range of
<code>[-(2**53)+1, (2**53)-1]</code>. In these circumstances, Appendix E of
<span>[<a href="#CDDL" class="cite xref">CDDL</a>]</span> recommends defining new CDDL types for int64 and
uint64 that limit their values to this range.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-3">While this can be sensible and workable for most use cases, some
protocols targeting qlog serialization (e.g., QUIC, HTTP/3), might
require full uint64 variables in some (rare) circumstances. In these
situations, it should be allowed to also use the string-based
representation of uint64 values alongside the numerical representation.
Concretely, the following definition of uint64 should override the
original and (web-based) tools should take into account that a uint64
field can be either a number or string.<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
<span id="name-custom-uint64-definition-fo"></span><div id="cddl-ijson-uint64-def">
<figure id="figure-36">
            <div class="alignLeft art-text artwork" id="section-6.1.1-4.1">
<pre>
uint64 = text / uint .size 8
</pre>
</div>
<figcaption><a href="#figure-36" class="selfRef">Figure 36</a>:
<a href="#name-custom-uint64-definition-fo" class="selfRef">Custom uint64 definition for I-JSON</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="truncated-values">
<section id="section-6.1.2">
          <h4 id="name-truncated-values">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-truncated-values" class="section-name selfRef">Truncated values</a>
          </h4>
<p id="section-6.1.2-1">For some use cases (e.g., limiting file size, privacy), it can be
necessary not to log a full raw blob (using the <code>hexstring</code> type) but
instead a truncated value (for example, only the first 100 bytes of an
HTTP response body to be able to discern which file it actually
contained). In these cases, the original byte-size length cannot be
obtained from the serialized value directly.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">As such, all qlog schema definitions <span class="bcp14">SHOULD</span> include a separate,
length-indicating field for all fields of type <code>hexstring</code> they specify,
see for example <a href="#raw-info" class="auto internal xref">Section 5.1</a>. This not only ensures the original length
can always be retrieved, but also allows the omission of any raw value
bytes of the field completely (e.g., out of privacy or security
considerations).<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<p id="section-6.1.2-3">To reduce overhead however and in the case the full raw value is logged,
the extra length-indicating field can be left out. As such, tools <span class="bcp14">MUST</span>
be able to deal with this situation and derive the length of the field
from the raw value if no separate length-indicating field is present.
The main possible permutations are shown by example in
<a href="#truncated-values-ex" class="auto internal xref">Figure 37</a>.<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
<span id="name-example-for-serializing-tru"></span><div id="truncated-values-ex">
<figure id="figure-37">
            <div class="alignLeft art-text artwork" id="section-6.1.2-4.1">
<pre>
// both the full raw value and its length are present
// (length is redundant)
{
    "raw_length": 5,
    "raw": "051428abff"
}

// only the raw value is present, indicating it
// represents the fields full value the byte
// length is obtained by calculating raw.length / 2
{
    "raw": "051428abff"
}

// only the length field is present, meaning the
// value was omitted
{
    "raw_length": 5,
}

// both fields are present and the lengths do not match:
// the value was truncated to the first three bytes.
{
    "raw_length": 5,
    "raw": "051428"
}
</pre>
</div>
<figcaption><a href="#figure-37" class="selfRef">Figure 37</a>:
<a href="#name-example-for-serializing-tru" class="selfRef">Example for serializing truncated hexstrings</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="format-json-seq">
<section id="section-6.2">
        <h3 id="name-qlog-to-json-text-sequences">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-qlog-to-json-text-sequences" class="section-name selfRef">qlog to JSON Text Sequences mapping</a>
        </h3>
<p id="section-6.2-1">One of the downsides of using pure JSON is that it is inherently a non-streamable
format. Put differently, it is not possible to simply append new qlog events to a
log file without "closing" this file at the end by appending "]}]}". Without these
closing tags, most JSON parsers will be unable to parse the file entirely. As most
platforms do not provide a standard streaming JSON parser (which would be able to
deal with this problem), this document also provides a qlog mapping to a
streamable JSON format called JSON Text Sequences (JSON-SEQ) (<span>[<a href="#RFC7464" class="cite xref">RFC7464</a>]</span>).<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">When mapping qlog to JSON-SEQ, the "qlog_format" field <span class="bcp14">MUST</span> have the value
"JSON-SEQ".<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">When using JSON-SEQ serialization, the file extension/suffix <span class="bcp14">SHOULD</span> be
".sqlog" (for "streaming" qlog) and the Media Type (if any) <span class="bcp14">SHOULD</span> be
"application/qlog+json-seq" per <span>[<a href="#RFC8091" class="cite xref">RFC8091</a>]</span>.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">JSON Text Sequences are very similar to JSON, except that JSON objects are
serialized as individual records, each prefixed by an ASCII Record Separator
(&lt;RS&gt;, 0x1E), and each ending with an ASCII Line Feed character (\n, 0x0A). Note
that each record can also contain any amount of newlines in its body, as long as
it ends with a newline character before the next &lt;RS&gt; character.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">Each qlog event is serialized and interpreted as an individual JSON Text Sequence
record, and can simply be appended as a new object at the back of an event stream
or log file. Put differently, unlike default JSON, it does not require a file to
be wrapped as a full object with "{ ... }" or "[... ]".<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">For this to work, some qlog definitions have to be adjusted however.
Mainly, events are no longer part of the "events" array in the Trace
object, but are instead logged separately from the qlog "header", as
indicated by the TraceSeq object in <a href="#trace-seq-def" class="auto internal xref">Figure 38</a>. Additionally,
qlog's JSON-SEQ mapping does not allow logging multiple individual
traces in a single qlog file. As such, the QlogFile:traces field is
replaced by the singular QlogFileSeq:trace field, see
<a href="#qlog-file-seq-def" class="auto internal xref">Figure 39</a>. An example can be seen in <a href="#json-seq-ex" class="auto internal xref">Figure 40</a>. Note
that the "group_id" field can still be used on a per-event basis to
include events from conceptually different sources in a single JSON-SEQ
qlog file.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<p id="section-6.2-7">Definition:<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<span id="name-traceseq-definition"></span><div id="trace-seq-def">
<figure id="figure-38">
          <div class="lang-cddl sourcecode" id="section-6.2-8.1">
<pre>
TraceSeq = {
    ? title: text
    ? description: text
    ? configuration: Configuration
    ? common_fields: CommonFields
    ? vantage_point: VantagePoint
}
</pre>
</div>
<figcaption><a href="#figure-38" class="selfRef">Figure 38</a>:
<a href="#name-traceseq-definition" class="selfRef">TraceSeq definition</a>
          </figcaption></figure>
</div>
<p id="section-6.2-9">Definition:<a href="#section-6.2-9" class="pilcrow">¶</a></p>
<span id="name-qlogfileseq-definition"></span><div id="qlog-file-seq-def">
<figure id="figure-39">
          <div class="lang-cddl sourcecode" id="section-6.2-10.1">
<pre>
QlogFileSeq = {
    qlog_format: "JSON-SEQ"

    qlog_version: text
    ? title: text
    ? description: text
    ? summary: Summary
    trace: TraceSeq
}
</pre>
</div>
<figcaption><a href="#figure-39" class="selfRef">Figure 39</a>:
<a href="#name-qlogfileseq-definition" class="selfRef">QlogFileSeq definition</a>
          </figcaption></figure>
</div>
<p id="section-6.2-11">JSON-SEQ serialization examples:<a href="#section-6.2-11" class="pilcrow">¶</a></p>
<span id="name-top-level-element"></span><div id="json-seq-ex">
<figure id="figure-40">
          <div class="alignLeft art-text artwork" id="section-6.2-12.1">
<pre>
// list of qlog events, serialized in accordance with RFC 7464,
// starting with a Record Separator character and ending with a
// newline.
// For display purposes, Record Separators are rendered as &lt;RS&gt;

&lt;RS&gt;{
    "qlog_version": "0.3",
    "qlog_format": "JSON-SEQ",
    "title": "Name of JSON Text Sequence qlog file (short)",
    "description": "Description for this trace file (long)",
    "summary": {
        ...
    },
    "trace": {
      "common_fields": {
        "protocol_type": ["QUIC","HTTP3"],
        "group_id":"127ecc830d98f9d54a42c4f0842aa87e181a",
        "time_format":"relative",
        "reference_time": 1553986553572
      },
      "vantage_point": {
        "name":"backend-67",
        "type":"server"
      }
    }
}
&lt;RS&gt;{"time": 2, "name": "transport:parameters_set", "data": { ... } }
&lt;RS&gt;{"time": 7, "name": "transport:packet_sent", "data": { ... } }
...
</pre>
</div>
<figcaption><a href="#figure-40" class="selfRef">Figure 40</a>:
<a href="#name-top-level-element" class="selfRef">Top-level element</a>
          </figcaption></figure>
</div>
<p id="section-6.2-13">Note: while not specifically required by the JSON-SEQ specification, all qlog
field names in a JSON-SEQ serialization <span class="bcp14">MUST</span> be lowercase.<a href="#section-6.2-13" class="pilcrow">¶</a></p>
<p id="section-6.2-14">In order to serialize all other CDDL-based qlog event and data structure
definitions to JSON-SEQ, the official CDDL-to-JSON mapping defined in
Appendix E of <span>[<a href="#CDDL" class="cite xref">CDDL</a>]</span> <span class="bcp14">SHOULD</span> still be employed.<a href="#section-6.2-14" class="pilcrow">¶</a></p>
<div id="supporting-json-text-sequences-in-tooling">
<section id="section-6.2.1">
          <h4 id="name-supporting-json-text-sequen">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-supporting-json-text-sequen" class="section-name selfRef">Supporting JSON Text Sequences in tooling</a>
          </h4>
<p id="section-6.2.1-1">Note that JSON Text Sequences are not supported in most default programming
environments (unlike normal JSON). However, several custom JSON-SEQ parsing
libraries exist in most programming languages that can be used and the format is
easy enough to parse with existing implementations (i.e., by splitting the file
into its component records and feeding them to a normal JSON parser individually,
as each record by itself is a valid JSON object).<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="optimizations">
<section id="section-6.3">
        <h3 id="name-other-optimized-formatting-">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-other-optimized-formatting-" class="section-name selfRef">Other optimized formatting options</a>
        </h3>
<p id="section-6.3-1">Both the JSON and JSON-SEQ formatting options described above are serviceable in
general small to medium scale (debugging) setups. However, these approaches tend
to be relatively verbose, leading to larger file sizes. Additionally, generalized
JSON(-SEQ) (de)serialization performance is typically (slightly) lower than that
of more optimized and predictable formats. Both aspects make these formats more
challenging (<a href="https://qlog.edm.uhasselt.be/anrw/">though still practical</a>) to use
in large scale setups.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">During the development of qlog, we compared a multitude of alternative formatting
and optimization options. The results of this study are <a href="https://github.com/quiclog/internet-drafts/issues/30#issuecomment-617675097">summarized on the qlog
github
repository</a>.
The rest of this section discusses some of these approaches implementations could
choose and the expected gains and tradeoffs inherent therein. Tools <span class="bcp14">SHOULD</span> support
mainly the compression options listed in <a href="#compression" class="auto internal xref">Section 6.3.2</a>, as they provide the
largest wins for the least cost overall.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">Over time, specific qlog formats and encodings can be created that more formally
define and combine some of the discussed optimizations or add new ones. We choose
to define these schemes in separate documents to keep the main qlog definition
clean and generalizable, as not all contexts require the same performance or
flexibility as others and qlog is intended to be a broadly usable and extensible
format (for example more flexibility is needed in earlier stages of protocol
development, while more performance is typically needed in later stages). This is
also the main reason why the general qlog format is the less optimized JSON
instead of a more performant option.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">To be able to easily distinguish between these options in qlog compatible tooling
(without the need to have the user provide out-of-band information or to
(heuristically) parse and process files in a multitude of ways, see also
<a href="#tooling" class="auto internal xref">Section 8</a>), we recommend using explicit file extensions to indicate specific
formats. As there are no standards in place for this type of extension to format
mapping, we employ a commonly used scheme here. Our approach is to list the
applied optimizations in the extension in ascending order of application (e.g., if
a qlog file is first optimized with technique A and then compressed with technique
B, the resulting file would have the extension ".(s)qlog.A.B"). This allows
tooling to start at the back of the extension to "undo" applied optimizations to
finally arrive at the expected qlog representation.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<div id="structure-optimizations">
<section id="section-6.3.1">
          <h4 id="name-data-structure-optimization">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-data-structure-optimization" class="section-name selfRef">Data structure optimizations</a>
          </h4>
<p id="section-6.3.1-1">The first general category of optimizations is to alter the representation of data
within an JSON(-SEQ) qlog file to reduce file size.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.3.1-2">The first option is to employ a scheme similar to the CSV (comma separated value
<span>[<a href="#RFC4180" class="cite xref">RFC4180</a>]</span>) format, which utilizes the concept of column "headers" to prevent
repeating field names for each datapoint instance. Concretely for JSON qlog,
several field names are repeated with each event (i.e., time, name, data). These
names could be extracted into a separate list, after which qlog events could be
serialized as an array of values, as opposed to a full object. This approach was a
key part of the original qlog format (prior to draft-02) using the "event_fields"
field. However, tests showed that this optimization only provided a mean file size
reduction of 5% (100MB to 95MB) while significantly increasing the implementation
complexity, and this approach was abandoned in favor of the default JSON setup.
Implementations using this format should not employ a separate file extension (as
it still uses JSON), but rather employ a new value of "JSON.namedheaders" (or
"JSON-SEQ.namedheaders") for the "qlog_format" field (see <a href="#top-level" class="auto internal xref">Section 3</a>).<a href="#section-6.3.1-2" class="pilcrow">¶</a></p>
<p id="section-6.3.1-3">The second option is to replace field values and/or names with indices into a
(dynamic) lookup table. This is a common compression technique and can provide
significant file size reductions (up to 50% in our tests, 100MB to 50MB). However,
this approach is even more difficult to implement efficiently and requires either
including the (dynamic) table in the resulting file (an approach taken by for
example <a href="https://www.chromium.org/developers/design-documents/network-stack/netlog">Chromium's NetLog
format</a>)
or defining a (static) table up-front and sharing this between implementations.
Implementations using this approach should not employ a separate file extension
(as it still uses JSON), but rather employ a new value of "JSON.dictionary" (or
"JSON-SEQ.dictionary") for the "qlog_format" field (see <a href="#top-level" class="auto internal xref">Section 3</a>).<a href="#section-6.3.1-3" class="pilcrow">¶</a></p>
<p id="section-6.3.1-4">As both options either proved difficult to implement, reduced qlog file
readability, and provided too little improvement compared to other more
straightforward options (for example <a href="#compression" class="auto internal xref">Section 6.3.2</a>), these schemes are not
inherently part of qlog.<a href="#section-6.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compression">
<section id="section-6.3.2">
          <h4 id="name-compression">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-compression" class="section-name selfRef">Compression</a>
          </h4>
<p id="section-6.3.2-1">The second general category of optimizations is to utilize a (generic) compression
scheme for textual data. As qlog in the JSON(-SEQ) format typically contains a
large amount of repetition, off-the-shelf (text) compression techniques typically
succeed very well in bringing down file sizes (regularly with up to two orders of
magnitude in our tests, even for "fast" compression levels). As such, utilizing
compression is recommended before attempting other optimization options, even
though this might (somewhat) increase processing costs due to the additional
compression step.<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<p id="section-6.3.2-2">The first option is to use GZIP compression (<span>[<a href="#RFC1952" class="cite xref">RFC1952</a>]</span>). This generic
compression scheme provides multiple compression levels (providing a trade-off
between compression speed and size reduction). Utilized at level 6 (a medium
setting thought to be applicable for streaming compression of a qlog stream in
commodity devices), gzip compresses qlog JSON files to 7% of their initial size on
average (100MB to 7MB). For this option, the file extension .(s)qlog.gz <span class="bcp14">SHOULD</span> BE
used. The "qlog_format" field should still reflect the original JSON formatting of
the qlog data (e.g., "JSON" or "JSON-SEQ").<a href="#section-6.3.2-2" class="pilcrow">¶</a></p>
<p id="section-6.3.2-3">The second option is to use Brotli compression (<span>[<a href="#RFC7932" class="cite xref">RFC7932</a>]</span>). While similar to
gzip, this more recent compression scheme provides a better efficiency. It also
allows multiple compression levels. Utilized at level 4 (a medium setting thought
to be applicable for streaming compression of a qlog stream in commodity devices),
brotli compresses qlog JSON files to 7% of their initial size on average (100MB to
7MB). For this option, the file extension .(s)qlog.br <span class="bcp14">SHOULD</span> BE used. The
"qlog_format" field should still reflect the original JSON formatting of the qlog
data (e.g., "JSON" or "JSON-SEQ").<a href="#section-6.3.2-3" class="pilcrow">¶</a></p>
<p id="section-6.3.2-4">Other compression algorithms of course exist (for example xz, zstd, and lz4). We
mainly recommend gzip and brotli because of their tweakable behaviour and wide
support in web-based environments, which we envision as the main tooling ecosystem
(see also <a href="#tooling" class="auto internal xref">Section 8</a>).<a href="#section-6.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="binary">
<section id="section-6.3.3">
          <h4 id="name-binary-formats">
<a href="#section-6.3.3" class="section-number selfRef">6.3.3. </a><a href="#name-binary-formats" class="section-name selfRef">Binary formats</a>
          </h4>
<p id="section-6.3.3-1">The third general category of optimizations is to use a more optimized (often
binary) format instead of the textual JSON format. This approach inherently
produces smaller files and often has better (de)serialization performance.
However, the resultant files are no longer human readable and some formats require
hard tradeoffs between flexibility for performance.<a href="#section-6.3.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3.3-2">The first option is to use the CBOR (Concise Binary Object Representation
<span>[<a href="#RFC7049" class="cite xref">RFC7049</a>]</span>) format. For our purposes, CBOR can be viewed as a straightforward
binary variant of JSON. As such, existing JSON qlog files can be trivially
converted to and from CBOR (though slightly more work is needed for JSON-SEQ qlogs
to convert them to CBOR-SEQ, see <span>[<a href="#RFC8742" class="cite xref">RFC8742</a>]</span>). While CBOR thus does retain the
full qlog flexibility, it only provides a 25% file size reduction (100MB to 75MB)
compared to textual JSON(-SEQ). As CBOR support in programming environments is not
as widespread as that of textual JSON and the format lacks human readability, CBOR
was not chosen as the default qlog format. For this option, the file extension
.(s)qlog.cbor <span class="bcp14">SHOULD</span> BE used. The "qlog_format" field should still reflect the
original JSON formatting of the qlog data (e.g., "JSON" or "JSON-SEQ"). The media
type should indicate both whether JSON or JSON Text Sequences are used, as well as
whether CBOR or CBOR Sequences are used (see the table below).<a href="#section-6.3.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3.3-3">A second option is to use a more specialized binary format, such as <a href="https://developers.google.com/protocol-buffers">Protocol
Buffers</a> (protobuf). This format
is battle-tested, has support for optional fields and has libraries in most
programming languages. Still, it is significantly less flexible than textual JSON
or CBOR, as it relies on a separate, pre-defined schema (a .proto file). As such,
it it not possible to (easily) log new event types in protobuf files without
adjusting this schema as well, which has its own practical challenges. As qlog is
intended to be a flexible, general purpose format, this type of format was not
chosen as its basic serialization. The lower flexibility does lead to
significantly reduced file sizes. Our straightforward mapping of the qlog main
schema and QUIC/HTTP3 event types to protobuf created qlog files 24% as large as
the raw JSON equivalents (100MB to 24MB). For this option, the file extension
.(s)qlog.protobuf <span class="bcp14">SHOULD</span> BE used. The "qlog_format" field should reflect the
different internal format, for example: "qlog_format": "protobuf".<a href="#section-6.3.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3.3-4">Note that binary formats can (and should) also be used in conjunction with
compression (see <a href="#compression" class="auto internal xref">Section 6.3.2</a>). For example, CBOR compresses well (to about 6%
of the original textual JSON size (100MB to 6MB) for both gzip and brotli) and so
does protobuf (5% (gzip) to 3% (brotli)). However, these gains are similar to the
ones achieved by simply compression the textual JSON equivalents directly (7%, see
<a href="#compression" class="auto internal xref">Section 6.3.2</a>). As such, since compression is still needed to achieve optimal
file size reductions event with binary formats, we feel the more flexible
compressed textual JSON options are a better default for the qlog format in
general.<a href="#section-6.3.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3.3-5"></p>
</section>
</div>
<div id="format-summary">
<section id="section-6.3.4">
          <h4 id="name-overview-and-summary">
<a href="#section-6.3.4" class="section-number selfRef">6.3.4. </a><a href="#name-overview-and-summary" class="section-name selfRef">Overview and summary</a>
          </h4>
<p id="section-6.3.4-1">In summary, textual JSON was chosen as the main qlog format due to its high
flexibility and because its inefficiencies can be largely solved by the
utilization of compression techniques (which are needed to achieve optimal results
with other formats as well).<a href="#section-6.3.4-1" class="pilcrow">¶</a></p>
<p id="section-6.3.4-2">Still, qlog implementers are free to define other qlog formats depending on their
needs and context of use. These formats should be described in their own
documents, the discussion in this document mainly acting as inspiration and
high-level guidance. Implementers are encouraged to add concrete qlog formats and
definitions to <a href="https://github.com/quiclog/qlog">the designated public
repository</a>.<a href="#section-6.3.4-2" class="pilcrow">¶</a></p>
<p id="section-6.3.4-3">The following table provides an overview of all the discussed qlog formatting
options with examples:<a href="#section-6.3.4-3" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
            <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">format</th>
                <th class="text-left" rowspan="1" colspan="1">qlog_format</th>
                <th class="text-left" rowspan="1" colspan="1">extension</th>
                <th class="text-left" rowspan="1" colspan="1">media type</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">JSON <a href="#format-json" class="auto internal xref">Section 6.1</a>
</td>
                <td class="text-left" rowspan="1" colspan="1">JSON</td>
                <td class="text-left" rowspan="1" colspan="1">.qlog</td>
                <td class="text-left" rowspan="1" colspan="1">application/qlog+json</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">JSON Text Sequences  <a href="#format-json-seq" class="auto internal xref">Section 6.2</a>
</td>
                <td class="text-left" rowspan="1" colspan="1">JSON-SEQ</td>
                <td class="text-left" rowspan="1" colspan="1">.sqlog</td>
                <td class="text-left" rowspan="1" colspan="1">application/qlog+json-seq</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">named headers <a href="#structure-optimizations" class="auto internal xref">Section 6.3.1</a>
</td>
                <td class="text-left" rowspan="1" colspan="1">JSON(-SEQ).namedheaders</td>
                <td class="text-left" rowspan="1" colspan="1">.(s)qlog</td>
                <td class="text-left" rowspan="1" colspan="1">application/qlog+json(-seq)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">dictionary <a href="#structure-optimizations" class="auto internal xref">Section 6.3.1</a>
</td>
                <td class="text-left" rowspan="1" colspan="1">JSON(-SEQ).dictionary</td>
                <td class="text-left" rowspan="1" colspan="1">.(s)qlog</td>
                <td class="text-left" rowspan="1" colspan="1">application/qlog+json(-seq)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CBOR <a href="#binary" class="auto internal xref">Section 6.3.3</a>
</td>
                <td class="text-left" rowspan="1" colspan="1">JSON(-SEQ)</td>
                <td class="text-left" rowspan="1" colspan="1">.(s)qlog.cbor</td>
                <td class="text-left" rowspan="1" colspan="1">application/qlog+json(-seq)+cbor(-seq)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">protobuf <a href="#binary" class="auto internal xref">Section 6.3.3</a>
</td>
                <td class="text-left" rowspan="1" colspan="1">protobuf</td>
                <td class="text-left" rowspan="1" colspan="1">.qlog.protobuf</td>
                <td class="text-left" rowspan="1" colspan="1">NOT SPECIFIED BY IANA</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1"> </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">gzip <a href="#compression" class="auto internal xref">Section 6.3.2</a>
</td>
                <td class="text-left" rowspan="1" colspan="1">no change</td>
                <td class="text-left" rowspan="1" colspan="1">.gz suffix</td>
                <td class="text-left" rowspan="1" colspan="1">application/gzip</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">brotli <a href="#compression" class="auto internal xref">Section 6.3.2</a>
</td>
                <td class="text-left" rowspan="1" colspan="1">no change</td>
                <td class="text-left" rowspan="1" colspan="1">.br suffix</td>
                <td class="text-left" rowspan="1" colspan="1">NOT SPECIFIED BY IANA</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="conversion">
<section id="section-6.4">
        <h3 id="name-conversion-between-formats">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-conversion-between-formats" class="section-name selfRef">Conversion between formats</a>
        </h3>
<p id="section-6.4-1">As discussed in the previous sections, a qlog file can be serialized in a
multitude of formats, each of which can conceivably be transformed into or from
one another without loss of information. For example, a number of JSON-SEQ
streamed qlogs could be combined into a JSON formatted qlog for later processing.
Similarly, a captured binary qlog could be transformed to JSON for easier
interpretation and sharing.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">Secondly, we can also consider other structured logging approaches that contain
similar (though typically not identical) data to qlog, like raw packet capture
files (for example .pcap files from tcpdump) or endpoint-specific logging formats
(for example the NetLog format in Google Chrome). These are sometimes the only
options, if an implementation cannot or will not support direct qlog output for
any reason, but does provide other internal or external (e.g., SSLKEYLOGFILE
export to allow decryption of packet captures) logging options For this second
category, a (partial) transformation from/to qlog can also be defined.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">As such, when defining a new qlog serialization format or wanting to utilize
qlog-compatible tools with existing codebases lacking qlog support, it is
recommended to define and provide a concrete mapping from one format to default
JSON-serialized qlog. Several of such mappings exist. Firstly,
[pcap2qlog]((https://github.com/quiclog/pcap2qlog) transforms QUIC and HTTP/3
packet capture files to qlog. Secondly,
<a href="https://github.com/quiclog/qvis/tree/master/visualizations/src/components/filemanager/netlogconverter">netlog2qlog</a>
converts chromium's internal dictionary-encoded JSON format to qlog. Finally,
<a href="https://github.com/quiclog/quictrace2qlog">quictrace2qlog</a> converts the older
quictrace format to JSON qlog. Tools can then easily integrate with these
converters (either by incorporating them directly or for example using them as a
(web-based) API) so users can provide different file types with ease. For example,
the <a href="https://qvis.edm.uhasselt.be">qvis</a> toolsuite supports a multitude of formats
and qlog serializations.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="methods-of-access-and-generation">
<section id="section-7">
      <h2 id="name-methods-of-access-and-gener">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-methods-of-access-and-gener" class="section-name selfRef">Methods of access and generation</a>
      </h2>
<p id="section-7-1">Different implementations will have different ways of generating and storing
qlogs. However, there is still value in defining a few default ways in which to
steer this generation and access of the results.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="set-file-output-destination-via-an-environment-variable">
<section id="section-7.1">
        <h3 id="name-set-file-output-destination">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-set-file-output-destination" class="section-name selfRef">Set file output destination via an environment variable</a>
        </h3>
<p id="section-7.1-1">To provide users control over where and how qlog files are created, we define two
environment variables. The first, QLOGFILE, indicates a full path to where an
individual qlog file should be stored. This path <span class="bcp14">MUST</span> include the full file
extension. The second, QLOGDIR, sets a general directory path in which qlog files
should be placed. This path <span class="bcp14">MUST</span> include the directory separator character at the
end.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">In general, QLOGDIR should be preferred over QLOGFILE if an endpoint is prone to
generate multiple qlog files. This can for example be the case for a QUIC server
implementation that logs each QUIC connection in a separate qlog file. An
alternative that uses QLOGFILE would be a QUIC server that logs all connections in
a single file and uses the "group_id" field (<a href="#group-ids" class="auto internal xref">Section 3.4.6</a>) to allow post-hoc
separation of events.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">Implementations <span class="bcp14">SHOULD</span> provide support for QLOGDIR and <span class="bcp14">MAY</span> provide support for
QLOGFILE.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">When using QLOGDIR, it is up to the implementation to choose an appropriate naming
scheme for the qlog files themselves. The chosen scheme will typically depend on
the context or protocols used. For example, for QUIC, it is recommended to use the
Original Destination Connection ID (ODCID), followed by the vantage point type of
the logging endpoint. Examples of all options for QUIC are shown in
<a href="#qlogdir-example" class="auto internal xref">Figure 41</a>.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<span id="name-environment-variable-exampl"></span><div id="qlogdir-example">
<figure id="figure-41">
          <div class="alignLeft art-text artwork" id="section-7.1-5.1">
<pre>
Command: QLOGFILE=/srv/qlogs/client.qlog quicclientbinary

Should result in the the quicclientbinary executable logging a
single qlog file named client.qlog in the /srv/qlogs directory.
This is for example useful in tests when the client sets up
just a single connection and then exits.

Command: QLOGDIR=/srv/qlogs/ quicserverbinary

Should result in the quicserverbinary executable generating
several logs files, one for each QUIC connection.
Given two QUIC connections, with ODCID values "abcde" and
"12345" respectively, this would result in two files:
/srv/qlogs/abcde_server.qlog
/srv/qlogs/12345_server.qlog

Command: QLOGFILE=/srv/qlogs/server.qlog quicserverbinary

Should result in the the quicserverbinary executable logging
a single qlog file named server.qlog in the /srv/qlogs directory.
Given that the server handled two QUIC connections before it was
shut down, with ODCID values "abcde" and "12345" respectively,
this would result in event instances in the qlog file being
tagged with the "group_id" field with values "abcde" and "12345".
</pre>
</div>
<figcaption><a href="#figure-41" class="selfRef">Figure 41</a>:
<a href="#name-environment-variable-exampl" class="selfRef">Environment variable examples for a QUIC implementation</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="access-logs-via-a-well-known-endpoint">
<section id="section-7.2">
        <h3 id="name-access-logs-via-a-well-know">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-access-logs-via-a-well-know" class="section-name selfRef">Access logs via a well-known endpoint</a>
        </h3>
<p id="section-7.2-1">After generation, qlog implementers <span class="bcp14">MAY</span> make available generated logs and traces
on an endpoint (typically the server) via the following .well-known URI:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.2-2.1">
            <p id="section-7.2-2.1.1">.well-known/qlog/IDENTIFIER.extension<a href="#section-7.2-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.2-3">The IDENTIFIER variable depends on the context and the protocol. For example for
QUIC, the lowercase Original Destination Connection ID (ODCID) is recommended, as
it can uniquely identify a connection. Additionally, the extension depends on the
chosen format (see <a href="#format-summary" class="auto internal xref">Section 6.3.4</a>). For example, for a QUIC connection with
ODCID "abcde", the endpoint for fetching its default JSON-formatted .qlog file
would be:<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.2-4.1">
            <p id="section-7.2-4.1.1">.well-known/qlog/abcde.qlog<a href="#section-7.2-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.2-5">Implementers <span class="bcp14">SHOULD</span> allow users to fetch logs for a given connection on a 2nd,
separate connection. This helps prevent pollution of the logs by fetching them
over the same connection that one wishes to observe through the log. Ideally, for
the QUIC use case, the logs should also be approachable via an HTTP/2 or HTTP/1.1
endpoint (i.e., on TCP port 443), to for example aid debugging in the case where
QUIC/UDP is blocked on the network.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">qlog implementers <span class="bcp14">SHOULD NOT</span> enable this .well-known endpoint in typical
production settings to prevent (malicious) users from downloading logs from other
connections. Implementers are advised to disable this endpoint by default and
require specific actions from the end users to enable it (and potentially qlog
itself). Implementers <span class="bcp14">MUST</span> also take into account the general privacy and security
guidelines discussed in <a href="#privacy" class="auto internal xref">Section 9</a> before exposing qlogs to outside actors.<a href="#section-7.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="tooling">
<section id="section-8">
      <h2 id="name-tooling-requirements">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-tooling-requirements" class="section-name selfRef">Tooling requirements</a>
      </h2>
<p id="section-8-1">Tools ingestion qlog <span class="bcp14">MUST</span> indicate which qlog version(s), qlog format(s),
compression methods and potentially other input file formats (for example .pcap)
they support. Tools <span class="bcp14">SHOULD</span> at least support .qlog files in the default JSON format
(<a href="#format-json" class="auto internal xref">Section 6.1</a>). Additionally, they <span class="bcp14">SHOULD</span> indicate exactly which values for and
properties of the name (category and type) and data fields they look for to
execute their logic. Tools <span class="bcp14">SHOULD</span> perform a (high-level) check if an input qlog
file adheres to the expected qlog schema. If a tool determines a qlog file does
not contain enough supported information to correctly execute the tool's logic, it
<span class="bcp14">SHOULD</span> generate a clear error message to this effect.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Tools <span class="bcp14">MUST NOT</span> produce breaking errors for any field names and/or values in the
qlog format that they do not recognize. Tools <span class="bcp14">SHOULD</span> indicate even unknown event
occurrences within their context (e.g., marking unknown events on a timeline for
manual interpretation by the user).<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Tool authors should be aware that, depending on the logging implementation, some
events will not always be present in all traces. For example, using a circular
logging buffer of a fixed size, it could be that the earliest events (e.g.,
connection setup events) are later overwritten by "newer" events. Alternatively,
some events can be intentionally omitted out of privacy or file size
considerations. Tool authors are encouraged to make their tools robust enough to
still provide adequate output for incomplete logs.<a href="#section-8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy">
<section id="section-9">
      <h2 id="name-security-and-privacy-consid">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-and-privacy-consid" class="section-name selfRef">Security and privacy considerations</a>
      </h2>
<p id="section-9-1">Protocols such as TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> and QUIC <span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span> provide varying degrees
of secure protection for the wire image <span>[<a href="#RFC8546" class="cite xref">RFC8546</a>]</span>. There is inevitably
tension between security and observability, when logging can reveal aspects of
the wire image, that would ordinarily be protected. This tension equally applies
to any privacy considerations that build on security properties, especially if
data can be correlated across data sources.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">qlog operators and implementers should be mindful of the security and privacy
risks inherent in handling qlog data. This includes but is not limited to
logging, storing, or using the data. Data might be considered as non-sensitive,
potentially-sensitive, or sensitive; applying the considerations in this section
may produce different risks depending on the nature of the data itself, or its
handling. However, in many cases the largest risk factors arise from data that
can be considered as potenially-sensitive or sensitive.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">The following is a non-exhaustive list of such fields and types of data that can
be carried in qlog data:<a href="#section-9-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-4.1">IP addresses and transport protocol port numbers, which can be used to
uniquely identify individual connections, endpoints, and potentially users.<a href="#section-9-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-4.2">Session, Connection, or User identifiers which can be used to correlate
nominally separate contexts. For example, QUIC Connection IDs can be used to
identify and track users across geographical networks <span><a href="https://rfc-editor.org/rfc/rfc9000#section-9.5" class="relref">Section 9.5</a> of [<a href="#RFC9000" class="cite xref">RFC9000</a>]</span>).<a href="#section-9-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-4.3">Stored State which can be used to correlate individual connections or sessions
over time. Examples include QUIC address validation and retry tokens, TLS
session tickets, and HTTP cookies.<a href="#section-9-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-4.4">Decryption keys, passwords, and tokens which can be used with other data
sources (e.g., captures of encrypted packets) to correlate qlog data to a
specific connection or user or leak additional information. Examples include
TLS decryption keys and HTTP-level API access or authorization tokens.<a href="#section-9-4.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-4.5">Data that can be used to correlate qlogs to other data sources (e.g., captures
of encrypted packets). Examples include high-resolution event timestamps or
inter-event timings, event counts, packet and frame sizes.<a href="#section-9-4.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-4.6">Full or partial encrypted raw packet and frame payloads, which can be used
with other data sources (e.g., captures of encrypted packets) to correlate
qlog data to a specific connection or session.<a href="#section-9-4.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-4.7">Full or partial plaintext raw packet and frame payloads (e.g., HTTP Field
values, HTTP response data, TLS SNI field values), which can contain directly
sensitive information.<a href="#section-9-4.7" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-9-5">The simplest and most extreme form of protection against abuse of this
information is the complete deletion of a given field, which is equivalent to
not logging the field(s) in question. While deletion completely protects the
data in the deleted fields from the risk of compromise, it also reduces the
utility of the dataset as a whole. As such, a balance should be found between
logging these fields and the potential risks inherent in their (involuntary)
disclosure. This balance depends on the use case at hand (e.g., research
datasets might have different requirements to live operational troubleshooting).
Capturing the minimal amount of data required for a specific purpose can help to
minimize the risks associated with data usage. qlog implementations that provide
fine-grained control over the inclusion of data fields, ideally on a
per-use-case or per-connection basis, improve the ability to minimize data.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">Any data that is determined to be necessary for a use case at hand could be
logged or captured. As per <span>[<a href="#RFC6973" class="cite xref">RFC6973</a>]</span>, operators must be aware that such data
will be at risk of compromise. As such, measures should be taken to firstly
reduce the risk of compromise and secondly reduce the risk of abuse of
compromised data. While a full discussion of both aspects is out of scope for
this document, the following paragraphs discuss high-level considerations that
can be applied to qlog data.<a href="#section-9-6" class="pilcrow">¶</a></p>
<p id="section-9-7">To reduce the risk of compromise, operators can take measures such as: limiting
the length of time that data is stored, encrypting data in transit and at rest,
limiting access rights to the data, and auditing data usage practices. qlog
deployments that provide integrated options for automated or manual data
deletion and (aggressive) aggregation, improve the ability to minimize the risk
of compromise.<a href="#section-9-7" class="pilcrow">¶</a></p>
<p id="section-9-8">To reduce the risk of data abuse after compromise, data can be anonymized,
pseudonymized, otherwise permutated/replaced, truncated, (re-)encrypted, or
aggregated. A partial discussion of applicable techniques (especially for IP
address information) can be found in <span><a href="https://rfc-editor.org/rfc/rfc8932#appendix-B" class="relref">Appendix B</a> of [<a href="#DNS-PRIVACY" class="cite xref">DNS-PRIVACY</a>]</span>.
Operators should, however, be aware that many of these techniques have been
shown to be insufficient to safeguard user privacy and/or to protect user
identity, especially if a qlog data set is large or easily correlated against
other data sources.<a href="#section-9-8" class="pilcrow">¶</a></p>
<p id="section-9-9">Finally, qlog operators should consider the interplay between their use case
needs and end user rights or preferences. While active user participation (as
indicated by <span>[<a href="#RFC6973" class="cite xref">RFC6973</a>]</span>) on a per-qlog basis is difficult, as logs are often
captured out-of-band to the main user interaction and intent, general user
expectations should be taken into account. qlog deployments that provide
mechanisms to integrate the capture, storage and removal of qlogs with more
general, often pre-existing, user preference and privacy control systems,
improve the ability to protect data sensitive or confidential to the end user.
In qlog, these data are typically (but not exclusively) contained in fields of
the RawInfo type (see <a href="#raw-info" class="auto internal xref">Section 5.1</a>). qlog users should thus be particularly
hesitant to include these fields for all but the most stringent use cases.<a href="#section-9-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">TODO: primarily the .well-known URI<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="CDDL">[CDDL]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNS-PRIVACY">[DNS-PRIVACY]</dt>
        <dd>
<span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Overeinder, B.</span>, <span class="refAuthor">van Rijswijk-Deij, R.</span>, and <span class="refAuthor">A. Mankin</span>, <span class="refTitle">"Recommendations for DNS Privacy Service Operators"</span>, <span class="seriesInfo">BCP 232</span>, <span class="seriesInfo">RFC 8932</span>, <span class="seriesInfo">DOI 10.17487/RFC8932</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8932">https://www.rfc-editor.org/rfc/rfc8932</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-JSON">[I-JSON]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The I-JSON Message Format"</span>, <span class="seriesInfo">RFC 7493</span>, <span class="seriesInfo">DOI 10.17487/RFC7493</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7493">https://www.rfc-editor.org/rfc/rfc7493</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JSON">[JSON]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JSON-Text-Sequences">[JSON-Text-Sequences]</dt>
        <dd>
<span class="refAuthor">Williams, N.</span>, <span class="refTitle">"JavaScript Object Notation (JSON) Text Sequences"</span>, <span class="seriesInfo">RFC 7464</span>, <span class="seriesInfo">DOI 10.17487/RFC7464</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7464">https://www.rfc-editor.org/rfc/rfc7464</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1952">[RFC1952]</dt>
        <dd>
<span class="refAuthor">Deutsch, P.</span>, <span class="refTitle">"GZIP file format specification version 4.3"</span>, <span class="seriesInfo">RFC 1952</span>, <span class="seriesInfo">DOI 10.17487/RFC1952</span>, <time datetime="1996-05" class="refDate">May 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1952">https://www.rfc-editor.org/rfc/rfc1952</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4180">[RFC4180]</dt>
        <dd>
<span class="refAuthor">Shafranovich, Y.</span>, <span class="refTitle">"Common Format and MIME Type for Comma-Separated Values (CSV) Files"</span>, <span class="seriesInfo">RFC 4180</span>, <span class="seriesInfo">DOI 10.17487/RFC4180</span>, <time datetime="2005-10" class="refDate">October 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4180">https://www.rfc-editor.org/rfc/rfc4180</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6839">[RFC6839]</dt>
        <dd>
<span class="refAuthor">Hansen, T.</span> and <span class="refAuthor">A. Melnikov</span>, <span class="refTitle">"Additional Media Type Structured Syntax Suffixes"</span>, <span class="seriesInfo">RFC 6839</span>, <span class="seriesInfo">DOI 10.17487/RFC6839</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6839">https://www.rfc-editor.org/rfc/rfc6839</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6973">https://www.rfc-editor.org/rfc/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7049">[RFC7049]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <span class="seriesInfo">DOI 10.17487/RFC7049</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7049">https://www.rfc-editor.org/rfc/rfc7049</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7464">[RFC7464]</dt>
        <dd>
<span class="refAuthor">Williams, N.</span>, <span class="refTitle">"JavaScript Object Notation (JSON) Text Sequences"</span>, <span class="seriesInfo">RFC 7464</span>, <span class="seriesInfo">DOI 10.17487/RFC7464</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7464">https://www.rfc-editor.org/rfc/rfc7464</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7932">[RFC7932]</dt>
        <dd>
<span class="refAuthor">Alakuijala, J.</span> and <span class="refAuthor">Z. Szabadka</span>, <span class="refTitle">"Brotli Compressed Data Format"</span>, <span class="seriesInfo">RFC 7932</span>, <span class="seriesInfo">DOI 10.17487/RFC7932</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7932">https://www.rfc-editor.org/rfc/rfc7932</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8091">[RFC8091]</dt>
        <dd>
<span class="refAuthor">Wilde, E.</span>, <span class="refTitle">"A Media Type Structured Syntax Suffix for JSON Text Sequences"</span>, <span class="seriesInfo">RFC 8091</span>, <span class="seriesInfo">DOI 10.17487/RFC8091</span>, <time datetime="2017-02" class="refDate">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8091">https://www.rfc-editor.org/rfc/rfc8091</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
      <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="QLOG-H3">[QLOG-H3]</dt>
        <dd>
<span class="refAuthor">Marx, R.</span>, <span class="refAuthor">Niccolini, L.</span>, <span class="refAuthor">Seemann, M.</span>, and <span class="refAuthor">L. Pardue</span>, <span class="refTitle">"HTTP/3 and QPACK qlog event definitions"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-qlog-h3-events-03</span>, <time datetime="2022-10-24" class="refDate">24 October 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-qlog-h3-events-03">https://datatracker.ietf.org/doc/html/draft-ietf-quic-qlog-h3-events-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QLOG-QUIC">[QLOG-QUIC]</dt>
        <dd>
<span class="refAuthor">Marx, R.</span>, <span class="refAuthor">Niccolini, L.</span>, <span class="refAuthor">Seemann, M.</span>, and <span class="refAuthor">L. Pardue</span>, <span class="refTitle">"QUIC event definitions for qlog"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-qlog-quic-events-03</span>, <time datetime="2022-10-24" class="refDate">24 October 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-qlog-quic-events-03">https://datatracker.ietf.org/doc/html/draft-ietf-quic-qlog-quic-events-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8546">[RFC8546]</dt>
        <dd>
<span class="refAuthor">Trammell, B.</span> and <span class="refAuthor">M. Kuehlewind</span>, <span class="refTitle">"The Wire Image of a Network Protocol"</span>, <span class="seriesInfo">RFC 8546</span>, <span class="seriesInfo">DOI 10.17487/RFC8546</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8546">https://www.rfc-editor.org/rfc/rfc8546</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8742">[RFC8742]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Sequences"</span>, <span class="seriesInfo">RFC 8742</span>, <span class="seriesInfo">DOI 10.17487/RFC8742</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8742">https://www.rfc-editor.org/rfc/rfc8742</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="change-log">
<section id="appendix-A">
      <h2 id="name-change-log">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<div id="since-draft-ietf-quic-qlog-main-schema-03">
<section id="appendix-A.1">
        <h3 id="name-since-draft-ietf-quic-qlog-">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-since-draft-ietf-quic-qlog-" class="section-name selfRef">Since draft-ietf-quic-qlog-main-schema-03:</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.1-1.1">Added security and privacy considerations discussion (#252)<a href="#appendix-A.1-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="since-draft-ietf-quic-qlog-main-schema-02">
<section id="appendix-A.2">
        <h3 id="name-since-draft-ietf-quic-qlog-m">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-since-draft-ietf-quic-qlog-m" class="section-name selfRef">Since draft-ietf-quic-qlog-main-schema-02:</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.2-1.1">No changes - new draft to prevent expiration<a href="#appendix-A.2-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="since-draft-ietf-quic-qlog-main-schema-01">
<section id="appendix-A.3">
        <h3 id="name-since-draft-ietf-quic-qlog-ma">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-since-draft-ietf-quic-qlog-ma" class="section-name selfRef">Since draft-ietf-quic-qlog-main-schema-01:</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.3-1.1">Change the data definition language from TypeScript to CDDL (#143)<a href="#appendix-A.3-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="since-draft-ietf-quic-qlog-main-schema-00">
<section id="appendix-A.4">
        <h3 id="name-since-draft-ietf-quic-qlog-mai">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-since-draft-ietf-quic-qlog-mai" class="section-name selfRef">Since draft-ietf-quic-qlog-main-schema-00:</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.4-1.1">Changed the streaming serialization format from NDJSON to JSON Text Sequences
(#172)<a href="#appendix-A.4-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.4-1.2">Added Media Type definitions for various qlog formats (#158)<a href="#appendix-A.4-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.4-1.3">Changed to semantic versioning<a href="#appendix-A.4-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="since-draft-marx-qlog-main-schema-draft-02">
<section id="appendix-A.5">
        <h3 id="name-since-draft-marx-qlog-main-">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-since-draft-marx-qlog-main-" class="section-name selfRef">Since draft-marx-qlog-main-schema-draft-02:</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.5-1.1">These changes were done in preparation of the adoption of the drafts by the QUIC
working group (#137)<a href="#appendix-A.5-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.5-1.2">Moved RawInfo, Importance, Generic events and Simulation events to this document.<a href="#appendix-A.5-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.5-1.3">Added basic event definition guidelines<a href="#appendix-A.5-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.5-1.4">Made protocol_type an array instead of a string (#146)<a href="#appendix-A.5-1.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="since-draft-marx-qlog-main-schema-01">
<section id="appendix-A.6">
        <h3 id="name-since-draft-marx-qlog-main-s">
<a href="#appendix-A.6" class="section-number selfRef">A.6. </a><a href="#name-since-draft-marx-qlog-main-s" class="section-name selfRef">Since draft-marx-qlog-main-schema-01:</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.6-1.1">
            <p id="appendix-A.6-1.1.1">Decoupled qlog from the JSON format and described a mapping instead (#89)<a href="#appendix-A.6-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.6-1.1.2.1">Data types are now specified in this document and proper definitions for
fields were added in this format<a href="#appendix-A.6-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="appendix-A.6-1.1.2.2">64-bit numbers can now be either strings or numbers, with a preference for
numbers (#10)<a href="#appendix-A.6-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="appendix-A.6-1.1.2.3">binary blobs are now logged as lowercase hex strings (#39, #36)<a href="#appendix-A.6-1.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="appendix-A.6-1.1.2.4">added guidance to add length-specifiers for binary blobs (#102)<a href="#appendix-A.6-1.1.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-A.6-1.2">Removed "time_units" from Configuration. All times are now in ms instead (#95)<a href="#appendix-A.6-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.6-1.3">Removed the "event_fields" setup for a more straightforward JSON format
(#101,#89)<a href="#appendix-A.6-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.6-1.4">Added a streaming option using the NDJSON format (#109,#2,#106)<a href="#appendix-A.6-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.6-1.5">Described optional optimization options for implementers (#30)<a href="#appendix-A.6-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.6-1.6">Added QLOGDIR and QLOGFILE environment variables, clarified the .well-known URL
usage (#26,#33,#51)<a href="#appendix-A.6-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.6-1.7">Overall tightened up the text and added more examples<a href="#appendix-A.6-1.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="since-draft-marx-qlog-main-schema-00">
<section id="appendix-A.7">
        <h3 id="name-since-draft-marx-qlog-main-sc">
<a href="#appendix-A.7" class="section-number selfRef">A.7. </a><a href="#name-since-draft-marx-qlog-main-sc" class="section-name selfRef">Since draft-marx-qlog-main-schema-00:</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.7-1.1">All field names are now lowercase (e.g., category instead of CATEGORY)<a href="#appendix-A.7-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.7-1.2">Triggers are now properties on the "data" field value, instead of separate field
types (#23)<a href="#appendix-A.7-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.7-1.3">group_ids in common_fields is now just also group_id<a href="#appendix-A.7-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">Much of the initial work by Robin Marx was done at the Hasselt and KU Leuven
Universities.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">Thanks to Jana Iyengar, Brian Trammell, Dmitri Tikhonov, Stephen Petrides, Jari
Arkko, Marcus Ihlar, Victor Vasiliev, Mirja Kuehlewind, and Jeremy Laine for
their feedback and suggestions.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Robin Marx (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Akamai</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rmarx@akamai.com" class="email">rmarx@akamai.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Luca Niccolini (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Meta</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:lniccolini@meta.com" class="email">lniccolini@meta.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marten Seemann (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Protocol Labs</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marten@protocol.ai" class="email">marten@protocol.ai</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Lucas Pardue (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:lucaspardue.24.7@gmail.com" class="email">lucaspardue.24.7@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
